============================================================================================================
Arguments =
	approach: bic
	batch_size: 100
	clipping: 10000
	datasets: ['miniimagenet']
	eval_on_train: False
	exp_name: None
	fix_bn: False
	gpu: 5
	gridsearch_tasks: -1
	keep_existing_head: False
	last_layer_analysis: False
	log: ['disk']
	lr: 0.05
	lr_factor: 1.0
	lr_min: 0.0001
	lr_patience: 5
	momentum: 0.9
	multi_softmax: False
	nc_first_task: 10
	nepochs: 100
	network: resnet18
	no_cudnn_deterministic: False
	num_tasks: 10
	num_workers: 4
	pin_memory: False
	pretrained: False
	results_path: ../miniimagenet_bic_result10t
	save_models: False
	seed: 12345
	stop_at_task: 0
	use_valid_only: False
	warmup_lr_factor: 1.0
	warmup_nepochs: 0
	weight_decay: 0.0002
============================================================================================================
Approach arguments =
	T: 2
	lamb: -1
	num_bias_epochs: 200
	val_exemplar_percentage: 0.1
============================================================================================================
Exemplars dataset arguments =
	exemplar_selection: random
	num_exemplars: 0
	num_exemplars_per_class: 50
============================================================================================================
WARNING: ../miniimagenet_bic_result10t/miniimagenet_bic already exists!
[(0, 10), (1, 10), (2, 10), (3, 10), (4, 10), (5, 10), (6, 10), (7, 10), (8, 10), (9, 10)]
************************************************************************************************************
Task  0
************************************************************************************************************
Stage 0: Select exemplars from validation
 > Selected 50 validation exemplars, time=  0.0s
Stage 1: Training model with distillation
| Epoch   1, time=  3.2s | Train: skip eval | Valid: time=  0.5s loss=2.953, TAw acc= 25.8% | *
| Epoch   2, time=  1.2s | Train: skip eval | Valid: time=  0.5s loss=2.617, TAw acc= 31.4% | *
| Epoch   3, time=  1.4s | Train: skip eval | Valid: time=  1.2s loss=2.990, TAw acc= 24.8% |
| Epoch   4, time=  1.3s | Train: skip eval | Valid: time=  0.4s loss=4.127, TAw acc= 32.8% |
| Epoch   5, time=  1.4s | Train: skip eval | Valid: time=  0.7s loss=1.876, TAw acc= 36.4% | *
| Epoch   6, time=  1.3s | Train: skip eval | Valid: time=  0.6s loss=1.782, TAw acc= 35.6% | *
| Epoch   7, time=  1.2s | Train: skip eval | Valid: time=  0.6s loss=1.978, TAw acc= 38.0% |
| Epoch   8, time=  1.2s | Train: skip eval | Valid: time=  0.5s loss=2.148, TAw acc= 39.4% |
| Epoch   9, time=  1.3s | Train: skip eval | Valid: time=  1.0s loss=1.940, TAw acc= 40.6% |
| Epoch  10, time=  1.5s | Train: skip eval | Valid: time=  0.7s loss=1.712, TAw acc= 39.4% | *
| Epoch  11, time=  1.2s | Train: skip eval | Valid: time=  0.6s loss=1.669, TAw acc= 43.0% | *
| Epoch  12, time=  1.3s | Train: skip eval | Valid: time=  0.6s loss=1.662, TAw acc= 43.8% | *
| Epoch  13, time=  1.3s | Train: skip eval | Valid: time=  0.5s loss=1.803, TAw acc= 41.8% |
| Epoch  14, time=  1.3s | Train: skip eval | Valid: time=  0.4s loss=1.687, TAw acc= 43.0% |
| Epoch  15, time=  2.1s | Train: skip eval | Valid: time=  0.7s loss=1.698, TAw acc= 40.0% |
| Epoch  16, time=  1.3s | Train: skip eval | Valid: time=  0.6s loss=1.554, TAw acc= 45.4% | *
| Epoch  17, time=  1.3s | Train: skip eval | Valid: time=  0.4s loss=1.543, TAw acc= 48.0% | *
| Epoch  18, time=  1.2s | Train: skip eval | Valid: time=  0.4s loss=1.573, TAw acc= 47.0% |
| Epoch  19, time=  1.4s | Train: skip eval | Valid: time=  0.6s loss=1.587, TAw acc= 44.8% |
| Epoch  20, time=  1.3s | Train: skip eval | Valid: time=  0.4s loss=1.499, TAw acc= 48.2% | *
| Epoch  21, time=  2.1s | Train: skip eval | Valid: time=  0.6s loss=1.488, TAw acc= 50.2% | *
| Epoch  22, time=  1.3s | Train: skip eval | Valid: time=  0.5s loss=1.497, TAw acc= 50.8% |
| Epoch  23, time=  1.3s | Train: skip eval | Valid: time=  0.7s loss=1.501, TAw acc= 48.6% |
| Epoch  24, time=  1.6s | Train: skip eval | Valid: time=  0.4s loss=1.452, TAw acc= 51.8% | *
| Epoch  25, time=  1.7s | Train: skip eval | Valid: time=  0.5s loss=1.432, TAw acc= 49.6% | *
| Epoch  26, time=  1.3s | Train: skip eval | Valid: time=  0.9s loss=1.460, TAw acc= 50.2% |
| Epoch  27, time=  1.3s | Train: skip eval | Valid: time=  0.6s loss=1.455, TAw acc= 52.0% |
| Epoch  28, time=  1.3s | Train: skip eval | Valid: time=  0.6s loss=1.438, TAw acc= 50.6% |
| Epoch  29, time=  1.4s | Train: skip eval | Valid: time=  0.6s loss=1.558, TAw acc= 48.4% |
| Epoch  30, time=  1.3s | Train: skip eval | Valid: time=  0.6s loss=1.437, TAw acc= 51.0% | lr=5.0e-02
| Epoch  31, time=  1.2s | Train: skip eval | Valid: time=  0.6s loss=1.469, TAw acc= 51.0% |
| Epoch  32, time=  2.3s | Train: skip eval | Valid: time=  0.5s loss=1.442, TAw acc= 52.0% |
| Epoch  33, time=  1.2s | Train: skip eval | Valid: time=  0.6s loss=1.433, TAw acc= 51.4% |
| Epoch  34, time=  1.3s | Train: skip eval | Valid: time=  0.8s loss=1.440, TAw acc= 51.8% |
| Epoch  35, time=  1.3s | Train: skip eval | Valid: time=  0.7s loss=1.392, TAw acc= 53.8% | *
| Epoch  36, time=  1.4s | Train: skip eval | Valid: time=  0.6s loss=1.431, TAw acc= 51.4% |
| Epoch  37, time=  2.1s | Train: skip eval | Valid: time=  0.5s loss=1.438, TAw acc= 53.2% |
| Epoch  38, time=  1.5s | Train: skip eval | Valid: time=  0.6s loss=1.462, TAw acc= 52.6% |
| Epoch  39, time=  1.2s | Train: skip eval | Valid: time=  0.6s loss=1.395, TAw acc= 55.2% |
| Epoch  40, time=  1.3s | Train: skip eval | Valid: time=  0.5s loss=1.451, TAw acc= 51.2% | lr=5.0e-02
| Epoch  41, time=  1.3s | Train: skip eval | Valid: time=  0.5s loss=1.437, TAw acc= 51.2% |
| Epoch  42, time=  1.3s | Train: skip eval | Valid: time=  0.6s loss=1.445, TAw acc= 52.0% |
| Epoch  43, time=  2.4s | Train: skip eval | Valid: time=  0.6s loss=1.429, TAw acc= 52.8% |
| Epoch  44, time=  1.3s | Train: skip eval | Valid: time=  0.6s loss=1.363, TAw acc= 54.8% | *
| Epoch  45, time=  1.3s | Train: skip eval | Valid: time=  0.5s loss=1.367, TAw acc= 56.6% |
| Epoch  46, time=  1.4s | Train: skip eval | Valid: time=  0.7s loss=1.406, TAw acc= 52.6% |
| Epoch  47, time=  1.6s | Train: skip eval | Valid: time=  0.6s loss=1.360, TAw acc= 55.8% | *
| Epoch  48, time=  1.2s | Train: skip eval | Valid: time=  0.6s loss=1.509, TAw acc= 49.0% |
| Epoch  49, time=  1.3s | Train: skip eval | Valid: time=  0.5s loss=1.394, TAw acc= 54.6% |
| Epoch  50, time=  1.4s | Train: skip eval | Valid: time=  0.5s loss=1.409, TAw acc= 56.0% |
| Epoch  51, time=  1.3s | Train: skip eval | Valid: time=  0.5s loss=1.379, TAw acc= 52.2% |
| Epoch  52, time=  1.4s | Train: skip eval | Valid: time=  0.7s loss=1.402, TAw acc= 52.6% | lr=5.0e-02
| Epoch  53, time=  1.3s | Train: skip eval | Valid: time=  0.4s loss=1.433, TAw acc= 52.0% |
| Epoch  54, time=  1.3s | Train: skip eval | Valid: time=  0.8s loss=1.364, TAw acc= 55.0% |
| Epoch  55, time=  1.3s | Train: skip eval | Valid: time=  0.6s loss=1.414, TAw acc= 53.0% |
| Epoch  56, time=  1.3s | Train: skip eval | Valid: time=  0.5s loss=1.422, TAw acc= 53.6% |
| Epoch  57, time=  1.2s | Train: skip eval | Valid: time=  0.6s loss=1.390, TAw acc= 54.2% | lr=5.0e-02
| Epoch  58, time=  1.4s | Train: skip eval | Valid: time=  0.5s loss=1.372, TAw acc= 55.8% |
| Epoch  59, time=  1.2s | Train: skip eval | Valid: time=  0.4s loss=1.378, TAw acc= 54.6% |
| Epoch  60, time=  1.4s | Train: skip eval | Valid: time=  1.6s loss=1.372, TAw acc= 55.0% |
| Epoch  61, time=  1.2s | Train: skip eval | Valid: time=  0.5s loss=1.426, TAw acc= 53.6% |
| Epoch  62, time=  1.3s | Train: skip eval | Valid: time=  0.5s loss=1.416, TAw acc= 56.0% | lr=5.0e-02
| Epoch  63, time=  1.3s | Train: skip eval | Valid: time=  0.5s loss=1.432, TAw acc= 53.6% |
| Epoch  64, time=  1.3s | Train: skip eval | Valid: time=  0.6s loss=1.393, TAw acc= 54.0% |
| Epoch  65, time=  1.2s | Train: skip eval | Valid: time=  0.6s loss=1.313, TAw acc= 57.4% | *
| Epoch  66, time=  2.2s | Train: skip eval | Valid: time=  0.6s loss=1.412, TAw acc= 51.6% |
| Epoch  67, time=  1.5s | Train: skip eval | Valid: time=  0.5s loss=1.474, TAw acc= 51.6% |
| Epoch  68, time=  1.3s | Train: skip eval | Valid: time=  0.5s loss=1.357, TAw acc= 55.6% |
| Epoch  69, time=  1.3s | Train: skip eval | Valid: time=  0.6s loss=1.452, TAw acc= 51.8% |
| Epoch  70, time=  1.3s | Train: skip eval | Valid: time=  0.5s loss=1.488, TAw acc= 55.6% | lr=5.0e-02
| Epoch  71, time=  1.5s | Train: skip eval | Valid: time=  1.5s loss=1.487, TAw acc= 49.0% |
| Epoch  72, time=  1.4s | Train: skip eval | Valid: time=  0.5s loss=1.413, TAw acc= 53.4% |
| Epoch  73, time=  1.5s | Train: skip eval | Valid: time=  0.4s loss=1.438, TAw acc= 49.6% |
| Epoch  74, time=  1.3s | Train: skip eval | Valid: time=  0.6s loss=1.366, TAw acc= 53.4% |
| Epoch  75, time=  1.2s | Train: skip eval | Valid: time=  0.5s loss=1.311, TAw acc= 55.8% | *
| Epoch  76, time=  1.3s | Train: skip eval | Valid: time=  0.5s loss=1.381, TAw acc= 53.0% |
| Epoch  77, time=  1.2s | Train: skip eval | Valid: time=  0.6s loss=1.398, TAw acc= 54.0% |
| Epoch  78, time=  1.2s | Train: skip eval | Valid: time=  0.6s loss=1.336, TAw acc= 54.6% |
| Epoch  79, time=  1.4s | Train: skip eval | Valid: time=  0.5s loss=1.355, TAw acc= 55.8% |
| Epoch  80, time=  1.2s | Train: skip eval | Valid: time=  0.5s loss=1.363, TAw acc= 52.8% | lr=5.0e-02
| Epoch  81, time=  1.4s | Train: skip eval | Valid: time=  0.5s loss=1.396, TAw acc= 54.0% |
| Epoch  82, time=  1.4s | Train: skip eval | Valid: time=  0.7s loss=1.327, TAw acc= 55.8% |
| Epoch  83, time=  1.3s | Train: skip eval | Valid: time=  0.5s loss=1.339, TAw acc= 57.2% |
| Epoch  84, time=  1.2s | Train: skip eval | Valid: time=  0.5s loss=1.402, TAw acc= 56.6% |
| Epoch  85, time=  1.4s | Train: skip eval | Valid: time=  0.6s loss=1.455, TAw acc= 52.4% | lr=5.0e-02
| Epoch  86, time=  1.3s | Train: skip eval | Valid: time=  0.5s loss=1.336, TAw acc= 55.6% |
| Epoch  87, time=  1.3s | Train: skip eval | Valid: time=  0.6s loss=1.392, TAw acc= 55.0% |
| Epoch  88, time=  1.4s | Train: skip eval | Valid: time=  0.4s loss=1.329, TAw acc= 58.0% |
| Epoch  89, time=  1.4s | Train: skip eval | Valid: time=  0.9s loss=1.376, TAw acc= 55.2% |
| Epoch  90, time=  1.3s | Train: skip eval | Valid: time=  0.6s loss=1.415, TAw acc= 53.0% | lr=5.0e-02
| Epoch  91, time=  1.3s | Train: skip eval | Valid: time=  0.6s loss=1.434, TAw acc= 52.8% |
| Epoch  92, time=  1.2s | Train: skip eval | Valid: time=  0.6s loss=1.306, TAw acc= 56.6% | *
| Epoch  93, time=  1.5s | Train: skip eval | Valid: time=  0.6s loss=1.328, TAw acc= 57.2% |
| Epoch  94, time=  1.4s | Train: skip eval | Valid: time=  0.5s loss=1.455, TAw acc= 53.4% |
| Epoch  95, time=  2.4s | Train: skip eval | Valid: time=  0.5s loss=1.381, TAw acc= 55.8% |
| Epoch  96, time=  1.3s | Train: skip eval | Valid: time=  0.6s loss=1.299, TAw acc= 55.8% | *
| Epoch  97, time=  1.4s | Train: skip eval | Valid: time=  0.6s loss=1.388, TAw acc= 54.2% |
| Epoch  98, time=  1.3s | Train: skip eval | Valid: time=  0.5s loss=1.387, TAw acc= 55.2% |
| Epoch  99, time=  1.5s | Train: skip eval | Valid: time=  0.6s loss=1.341, TAw acc= 56.2% |
| Epoch 100, time=  2.0s | Train: skip eval | Valid: time=  0.7s loss=1.376, TAw acc= 54.0% |
Stage 2: BiC training for Task 0: alpha=1.00000, beta=0.00000
| Selected 450 train exemplars, time=  0.0s
------------------------------------------------------------------------------------------------------------
>>> Test on task  0 : loss=1.300 | TAw acc= 57.0%, forg=  0.0%| TAg acc= 57.0%, forg=  0.0% <<<
Save at ../miniimagenet_bic_result10t/miniimagenet_bic
************************************************************************************************************
Task  1
************************************************************************************************************
Stage 0: Select exemplars from validation
 > Selected 100 validation exemplars, time=  0.0s
Stage 1: Training model with distillation
| Epoch   1, time=  1.6s | Train: skip eval | Valid: time=  0.5s loss=1.925, TAw acc= 39.0% | *
| Epoch   2, time=  1.6s | Train: skip eval | Valid: time=  0.6s loss=1.847, TAw acc= 44.0% | *
| Epoch   3, time=  1.6s | Train: skip eval | Valid: time=  0.5s loss=1.803, TAw acc= 49.0% | *
| Epoch   4, time=  1.6s | Train: skip eval | Valid: time=  0.5s loss=1.794, TAw acc= 49.6% | *
| Epoch   5, time=  2.4s | Train: skip eval | Valid: time=  0.5s loss=1.757, TAw acc= 51.4% | *
| Epoch   6, time=  1.6s | Train: skip eval | Valid: time=  0.6s loss=1.766, TAw acc= 49.0% |
| Epoch   7, time=  1.8s | Train: skip eval | Valid: time=  0.5s loss=1.778, TAw acc= 49.4% |
| Epoch   8, time=  1.6s | Train: skip eval | Valid: time=  0.6s loss=1.758, TAw acc= 51.6% |
| Epoch   9, time=  1.7s | Train: skip eval | Valid: time=  0.5s loss=1.742, TAw acc= 52.4% | *
| Epoch  10, time=  2.2s | Train: skip eval | Valid: time=  0.5s loss=1.744, TAw acc= 53.2% |
| Epoch  11, time=  1.6s | Train: skip eval | Valid: time=  0.5s loss=1.740, TAw acc= 52.0% | *
| Epoch  12, time=  1.6s | Train: skip eval | Valid: time=  0.5s loss=1.751, TAw acc= 51.0% |
| Epoch  13, time=  1.8s | Train: skip eval | Valid: time=  0.7s loss=1.767, TAw acc= 52.8% |
| Epoch  14, time=  1.7s | Train: skip eval | Valid: time=  0.4s loss=1.730, TAw acc= 53.6% | *
| Epoch  15, time=  2.3s | Train: skip eval | Valid: time=  0.6s loss=1.756, TAw acc= 53.2% |
| Epoch  16, time=  1.6s | Train: skip eval | Valid: time=  0.5s loss=1.730, TAw acc= 54.2% | *
| Epoch  17, time=  1.7s | Train: skip eval | Valid: time=  0.7s loss=1.745, TAw acc= 52.6% |
| Epoch  18, time=  1.7s | Train: skip eval | Valid: time=  0.5s loss=1.758, TAw acc= 54.6% |
| Epoch  19, time=  1.7s | Train: skip eval | Valid: time=  1.1s loss=1.704, TAw acc= 55.6% | *
| Epoch  20, time=  1.6s | Train: skip eval | Valid: time=  0.6s loss=1.824, TAw acc= 49.0% |
| Epoch  21, time=  1.8s | Train: skip eval | Valid: time=  0.7s loss=1.780, TAw acc= 51.6% |
| Epoch  22, time=  1.7s | Train: skip eval | Valid: time=  0.5s loss=1.748, TAw acc= 53.2% |
| Epoch  23, time=  1.6s | Train: skip eval | Valid: time=  0.6s loss=1.710, TAw acc= 56.8% |
| Epoch  24, time=  1.6s | Train: skip eval | Valid: time=  0.7s loss=1.750, TAw acc= 55.6% | lr=5.0e-02
| Epoch  25, time=  1.7s | Train: skip eval | Valid: time=  0.6s loss=1.735, TAw acc= 55.2% |
| Epoch  26, time=  1.7s | Train: skip eval | Valid: time=  0.5s loss=1.737, TAw acc= 54.0% |
| Epoch  27, time=  1.6s | Train: skip eval | Valid: time=  0.6s loss=1.743, TAw acc= 52.4% |
| Epoch  28, time=  1.6s | Train: skip eval | Valid: time=  0.6s loss=1.742, TAw acc= 56.2% |
| Epoch  29, time=  1.6s | Train: skip eval | Valid: time=  0.8s loss=1.724, TAw acc= 56.2% | lr=5.0e-02
| Epoch  30, time=  1.6s | Train: skip eval | Valid: time=  0.7s loss=1.754, TAw acc= 53.0% |
| Epoch  31, time=  1.7s | Train: skip eval | Valid: time=  0.5s loss=1.723, TAw acc= 54.2% |
| Epoch  32, time=  1.6s | Train: skip eval | Valid: time=  0.5s loss=1.730, TAw acc= 54.0% |
| Epoch  33, time=  1.5s | Train: skip eval | Valid: time=  0.6s loss=1.717, TAw acc= 54.8% |
| Epoch  34, time=  1.6s | Train: skip eval | Valid: time=  1.0s loss=1.766, TAw acc= 54.8% | lr=5.0e-02
| Epoch  35, time=  1.5s | Train: skip eval | Valid: time=  0.4s loss=1.751, TAw acc= 51.8% |
| Epoch  36, time=  1.8s | Train: skip eval | Valid: time=  0.6s loss=1.759, TAw acc= 53.0% |
| Epoch  37, time=  1.6s | Train: skip eval | Valid: time=  0.6s loss=1.752, TAw acc= 51.6% |
| Epoch  38, time=  1.7s | Train: skip eval | Valid: time=  0.8s loss=1.759, TAw acc= 53.2% |
| Epoch  39, time=  1.7s | Train: skip eval | Valid: time=  0.7s loss=1.728, TAw acc= 55.0% | lr=5.0e-02
| Epoch  40, time=  1.5s | Train: skip eval | Valid: time=  0.7s loss=1.741, TAw acc= 51.8% |
| Epoch  41, time=  1.8s | Train: skip eval | Valid: time=  0.6s loss=1.743, TAw acc= 52.8% |
| Epoch  42, time=  1.8s | Train: skip eval | Valid: time=  0.5s loss=1.750, TAw acc= 53.2% |
| Epoch  43, time=  1.8s | Train: skip eval | Valid: time=  0.5s loss=1.762, TAw acc= 53.2% |
| Epoch  44, time=  1.7s | Train: skip eval | Valid: time=  0.7s loss=1.740, TAw acc= 56.6% | lr=5.0e-02
| Epoch  45, time=  1.8s | Train: skip eval | Valid: time=  0.6s loss=1.767, TAw acc= 52.4% |
| Epoch  46, time=  1.8s | Train: skip eval | Valid: time=  0.4s loss=1.752, TAw acc= 54.4% |
| Epoch  47, time=  1.6s | Train: skip eval | Valid: time=  0.6s loss=1.703, TAw acc= 55.8% | *
| Epoch  48, time=  1.6s | Train: skip eval | Valid: time=  0.6s loss=1.781, TAw acc= 53.4% |
| Epoch  49, time=  1.6s | Train: skip eval | Valid: time=  1.0s loss=1.736, TAw acc= 53.2% |
| Epoch  50, time=  1.6s | Train: skip eval | Valid: time=  0.5s loss=1.740, TAw acc= 54.8% |
| Epoch  51, time=  1.9s | Train: skip eval | Valid: time=  0.5s loss=1.708, TAw acc= 56.4% |
| Epoch  52, time=  1.7s | Train: skip eval | Valid: time=  0.7s loss=1.770, TAw acc= 53.4% | lr=5.0e-02
| Epoch  53, time=  1.6s | Train: skip eval | Valid: time=  0.6s loss=1.716, TAw acc= 54.8% |
| Epoch  54, time=  2.8s | Train: skip eval | Valid: time=  0.5s loss=1.770, TAw acc= 54.0% |
| Epoch  55, time=  1.6s | Train: skip eval | Valid: time=  0.5s loss=1.719, TAw acc= 56.6% |
| Epoch  56, time=  1.8s | Train: skip eval | Valid: time=  0.6s loss=1.753, TAw acc= 55.4% |
| Epoch  57, time=  1.6s | Train: skip eval | Valid: time=  0.6s loss=1.762, TAw acc= 54.6% | lr=5.0e-02
| Epoch  58, time=  1.5s | Train: skip eval | Valid: time=  1.5s loss=1.744, TAw acc= 54.4% |
| Epoch  59, time=  1.6s | Train: skip eval | Valid: time=  0.6s loss=1.756, TAw acc= 57.2% |
| Epoch  60, time=  1.8s | Train: skip eval | Valid: time=  0.5s loss=1.748, TAw acc= 54.8% |
| Epoch  61, time=  1.6s | Train: skip eval | Valid: time=  0.6s loss=1.722, TAw acc= 56.8% |
| Epoch  62, time=  1.7s | Train: skip eval | Valid: time=  0.6s loss=1.725, TAw acc= 57.4% | lr=5.0e-02
| Epoch  63, time=  1.5s | Train: skip eval | Valid: time=  0.8s loss=1.727, TAw acc= 54.8% |
| Epoch  64, time=  1.8s | Train: skip eval | Valid: time=  0.6s loss=1.704, TAw acc= 57.2% |
| Epoch  65, time=  1.7s | Train: skip eval | Valid: time=  0.6s loss=1.767, TAw acc= 53.2% |
| Epoch  66, time=  1.8s | Train: skip eval | Valid: time=  0.8s loss=1.727, TAw acc= 56.0% |
| Epoch  67, time=  1.5s | Train: skip eval | Valid: time=  0.6s loss=1.714, TAw acc= 57.6% | lr=5.0e-02
| Epoch  68, time=  1.6s | Train: skip eval | Valid: time=  0.9s loss=1.772, TAw acc= 53.2% |
| Epoch  69, time=  1.8s | Train: skip eval | Valid: time=  0.6s loss=1.727, TAw acc= 55.4% |
| Epoch  70, time=  1.6s | Train: skip eval | Valid: time=  0.7s loss=1.763, TAw acc= 53.6% |
| Epoch  71, time=  1.5s | Train: skip eval | Valid: time=  0.6s loss=1.731, TAw acc= 58.4% |
| Epoch  72, time=  1.7s | Train: skip eval | Valid: time=  0.5s loss=1.752, TAw acc= 54.4% | lr=5.0e-02
| Epoch  73, time=  2.7s | Train: skip eval | Valid: time=  0.6s loss=1.756, TAw acc= 52.2% |
| Epoch  74, time=  1.7s | Train: skip eval | Valid: time=  0.5s loss=1.718, TAw acc= 57.0% |
| Epoch  75, time=  1.8s | Train: skip eval | Valid: time=  0.5s loss=1.729, TAw acc= 54.8% |
| Epoch  76, time=  1.7s | Train: skip eval | Valid: time=  0.8s loss=1.760, TAw acc= 52.8% |
| Epoch  77, time=  1.7s | Train: skip eval | Valid: time=  1.2s loss=1.724, TAw acc= 56.2% | lr=5.0e-02
| Epoch  78, time=  1.5s | Train: skip eval | Valid: time=  0.5s loss=1.785, TAw acc= 54.0% |
| Epoch  79, time=  1.6s | Train: skip eval | Valid: time=  0.6s loss=1.746, TAw acc= 52.6% |
| Epoch  80, time=  1.6s | Train: skip eval | Valid: time=  0.5s loss=1.727, TAw acc= 54.0% |
| Epoch  81, time=  1.7s | Train: skip eval | Valid: time=  0.5s loss=1.735, TAw acc= 55.6% |
| Epoch  82, time=  1.8s | Train: skip eval | Valid: time=  1.1s loss=1.734, TAw acc= 55.0% | lr=5.0e-02
| Epoch  83, time=  1.8s | Train: skip eval | Valid: time=  0.5s loss=1.744, TAw acc= 52.6% |
| Epoch  84, time=  1.5s | Train: skip eval | Valid: time=  0.6s loss=1.719, TAw acc= 52.8% |
| Epoch  85, time=  1.5s | Train: skip eval | Valid: time=  0.5s loss=1.798, TAw acc= 52.4% |
| Epoch  86, time=  1.8s | Train: skip eval | Valid: time=  0.6s loss=1.724, TAw acc= 55.2% |
| Epoch  87, time=  1.6s | Train: skip eval | Valid: time=  1.0s loss=1.734, TAw acc= 54.6% | lr=5.0e-02
| Epoch  88, time=  1.7s | Train: skip eval | Valid: time=  0.6s loss=1.766, TAw acc= 53.8% |
| Epoch  89, time=  1.7s | Train: skip eval | Valid: time=  0.5s loss=1.763, TAw acc= 54.6% |
| Epoch  90, time=  1.6s | Train: skip eval | Valid: time=  0.6s loss=1.713, TAw acc= 57.8% |
| Epoch  91, time=  1.7s | Train: skip eval | Valid: time=  0.6s loss=1.753, TAw acc= 53.8% |
| Epoch  92, time=  1.7s | Train: skip eval | Valid: time=  0.6s loss=1.743, TAw acc= 55.0% | lr=5.0e-02
| Epoch  93, time=  1.6s | Train: skip eval | Valid: time=  0.5s loss=1.773, TAw acc= 51.2% |
| Epoch  94, time=  1.7s | Train: skip eval | Valid: time=  0.6s loss=1.731, TAw acc= 56.0% |
| Epoch  95, time=  1.8s | Train: skip eval | Valid: time=  0.5s loss=1.745, TAw acc= 57.4% |
| Epoch  96, time=  1.5s | Train: skip eval | Valid: time=  0.6s loss=1.766, TAw acc= 53.2% |
| Epoch  97, time=  1.7s | Train: skip eval | Valid: time=  0.9s loss=1.696, TAw acc= 56.4% | *
| Epoch  98, time=  1.7s | Train: skip eval | Valid: time=  0.5s loss=1.767, TAw acc= 54.8% |
| Epoch  99, time=  1.8s | Train: skip eval | Valid: time=  0.5s loss=1.698, TAw acc= 56.2% |
| Epoch 100, time=  1.6s | Train: skip eval | Valid: time=  0.5s loss=1.737, TAw acc= 55.4% |
Stage 2: Training bias correction layers
| Epoch  50, time=  0.4s | Train: loss=2.050, TAg acc= 39.0% |
| Epoch 100, time=  0.4s | Train: loss=2.208, TAg acc= 34.0% |
| Epoch 150, time=  0.4s | Train: loss=2.152, TAg acc= 34.0% |
| Epoch 200, time=  0.4s | Train: loss=2.130, TAg acc= 33.0% |
Stage 2: BiC training for Task 0: alpha=1.00000, beta=0.00000
Stage 2: BiC training for Task 1: alpha=0.71168, beta=-0.79590
| Selected 900 train exemplars, time=  0.0s
------------------------------------------------------------------------------------------------------------
>>> Test on task  0 : loss=2.062 | TAw acc= 57.6%, forg= -0.6%| TAg acc= 41.5%, forg= 15.5% <<<
>>> Test on task  1 : loss=1.826 | TAw acc= 59.7%, forg=  0.0%| TAg acc= 48.9%, forg=  0.0% <<<
Save at ../miniimagenet_bic_result10t/miniimagenet_bic
************************************************************************************************************
Task  2
************************************************************************************************************
Stage 0: Select exemplars from validation
 > Selected 150 validation exemplars, time=  0.0s
Stage 1: Training model with distillation
| Epoch   1, time=  1.8s | Train: skip eval | Valid: time=  0.4s loss=2.404, TAw acc= 44.0% | *
| Epoch   2, time=  1.7s | Train: skip eval | Valid: time=  0.6s loss=2.374, TAw acc= 47.8% | *
| Epoch   3, time=  1.7s | Train: skip eval | Valid: time=  0.6s loss=2.363, TAw acc= 50.0% | *
| Epoch   4, time=  1.7s | Train: skip eval | Valid: time=  0.5s loss=2.366, TAw acc= 49.4% |
| Epoch   5, time=  2.8s | Train: skip eval | Valid: time=  0.6s loss=2.356, TAw acc= 49.4% | *
| Epoch   6, time=  1.8s | Train: skip eval | Valid: time=  0.5s loss=2.363, TAw acc= 48.4% |
| Epoch   7, time=  1.8s | Train: skip eval | Valid: time=  0.5s loss=2.350, TAw acc= 50.4% | *
| Epoch   8, time=  1.8s | Train: skip eval | Valid: time=  0.5s loss=2.339, TAw acc= 48.8% | *
| Epoch   9, time=  1.8s | Train: skip eval | Valid: time=  0.9s loss=2.374, TAw acc= 48.2% |
| Epoch  10, time=  1.7s | Train: skip eval | Valid: time=  0.7s loss=2.342, TAw acc= 53.8% |
| Epoch  11, time=  1.8s | Train: skip eval | Valid: time=  0.6s loss=2.344, TAw acc= 52.2% |
| Epoch  12, time=  1.7s | Train: skip eval | Valid: time=  0.5s loss=2.374, TAw acc= 51.8% |
| Epoch  13, time=  1.8s | Train: skip eval | Valid: time=  0.6s loss=2.343, TAw acc= 51.0% | lr=5.0e-02
| Epoch  14, time=  2.9s | Train: skip eval | Valid: time=  0.5s loss=2.358, TAw acc= 48.2% |
| Epoch  15, time=  1.9s | Train: skip eval | Valid: time=  0.5s loss=2.362, TAw acc= 50.2% |
| Epoch  16, time=  1.8s | Train: skip eval | Valid: time=  0.5s loss=2.359, TAw acc= 48.4% |
| Epoch  17, time=  2.0s | Train: skip eval | Valid: time=  0.6s loss=2.370, TAw acc= 50.4% |
| Epoch  18, time=  1.7s | Train: skip eval | Valid: time=  0.8s loss=2.365, TAw acc= 51.8% | lr=5.0e-02
| Epoch  19, time=  1.8s | Train: skip eval | Valid: time=  0.6s loss=2.348, TAw acc= 52.2% |
| Epoch  20, time=  1.7s | Train: skip eval | Valid: time=  0.5s loss=2.326, TAw acc= 52.2% | *
| Epoch  21, time=  1.8s | Train: skip eval | Valid: time=  0.6s loss=2.362, TAw acc= 50.6% |
| Epoch  22, time=  1.8s | Train: skip eval | Valid: time=  0.6s loss=2.346, TAw acc= 53.0% |
| Epoch  23, time=  2.6s | Train: skip eval | Valid: time=  0.6s loss=2.332, TAw acc= 53.6% |
| Epoch  24, time=  1.7s | Train: skip eval | Valid: time=  0.8s loss=2.367, TAw acc= 51.8% |
| Epoch  25, time=  1.7s | Train: skip eval | Valid: time=  0.6s loss=2.345, TAw acc= 53.2% | lr=5.0e-02
| Epoch  26, time=  1.8s | Train: skip eval | Valid: time=  0.5s loss=2.338, TAw acc= 53.2% |
| Epoch  27, time=  1.8s | Train: skip eval | Valid: time=  0.7s loss=2.349, TAw acc= 51.6% |
| Epoch  28, time=  1.7s | Train: skip eval | Valid: time=  0.4s loss=2.365, TAw acc= 50.2% |
| Epoch  29, time=  1.7s | Train: skip eval | Valid: time=  0.6s loss=2.351, TAw acc= 51.4% |
| Epoch  30, time=  1.9s | Train: skip eval | Valid: time=  0.5s loss=2.349, TAw acc= 51.4% | lr=5.0e-02
| Epoch  31, time=  1.8s | Train: skip eval | Valid: time=  0.4s loss=2.348, TAw acc= 49.4% |
| Epoch  32, time=  1.8s | Train: skip eval | Valid: time=  0.5s loss=2.352, TAw acc= 52.0% |
| Epoch  33, time=  1.7s | Train: skip eval | Valid: time=  0.7s loss=2.355, TAw acc= 51.2% |
| Epoch  34, time=  1.9s | Train: skip eval | Valid: time=  0.5s loss=2.368, TAw acc= 51.4% |
| Epoch  35, time=  1.7s | Train: skip eval | Valid: time=  0.6s loss=2.376, TAw acc= 50.8% | lr=5.0e-02
| Epoch  36, time=  1.9s | Train: skip eval | Valid: time=  0.6s loss=2.355, TAw acc= 55.6% |
| Epoch  37, time=  2.6s | Train: skip eval | Valid: time=  0.6s loss=2.350, TAw acc= 53.2% |
| Epoch  38, time=  1.9s | Train: skip eval | Valid: time=  0.5s loss=2.346, TAw acc= 52.8% |
| Epoch  39, time=  1.8s | Train: skip eval | Valid: time=  0.5s loss=2.377, TAw acc= 51.0% |
| Epoch  40, time=  1.8s | Train: skip eval | Valid: time=  0.6s loss=2.355, TAw acc= 51.0% | lr=5.0e-02
| Epoch  41, time=  1.7s | Train: skip eval | Valid: time=  0.9s loss=2.343, TAw acc= 51.8% |
| Epoch  42, time=  1.7s | Train: skip eval | Valid: time=  0.5s loss=2.389, TAw acc= 48.4% |
| Epoch  43, time=  1.8s | Train: skip eval | Valid: time=  0.5s loss=2.354, TAw acc= 53.0% |
| Epoch  44, time=  1.9s | Train: skip eval | Valid: time=  0.7s loss=2.373, TAw acc= 50.8% |
| Epoch  45, time=  1.9s | Train: skip eval | Valid: time=  0.6s loss=2.358, TAw acc= 53.0% | lr=5.0e-02
| Epoch  46, time=  3.0s | Train: skip eval | Valid: time=  0.5s loss=2.351, TAw acc= 51.4% |
| Epoch  47, time=  1.7s | Train: skip eval | Valid: time=  0.7s loss=2.368, TAw acc= 50.6% |
| Epoch  48, time=  1.8s | Train: skip eval | Valid: time=  0.5s loss=2.341, TAw acc= 51.0% |
| Epoch  49, time=  1.7s | Train: skip eval | Valid: time=  0.5s loss=2.349, TAw acc= 51.4% |
| Epoch  50, time=  1.8s | Train: skip eval | Valid: time=  0.7s loss=2.340, TAw acc= 56.0% | lr=5.0e-02
| Epoch  51, time=  1.9s | Train: skip eval | Valid: time=  0.5s loss=2.362, TAw acc= 49.0% |
| Epoch  52, time=  1.7s | Train: skip eval | Valid: time=  0.6s loss=2.362, TAw acc= 51.0% |
| Epoch  53, time=  1.7s | Train: skip eval | Valid: time=  0.5s loss=2.391, TAw acc= 48.4% |
| Epoch  54, time=  1.8s | Train: skip eval | Valid: time=  0.5s loss=2.345, TAw acc= 54.4% |
| Epoch  55, time=  1.8s | Train: skip eval | Valid: time=  0.5s loss=2.345, TAw acc= 50.4% | lr=5.0e-02
| Epoch  56, time=  1.8s | Train: skip eval | Valid: time=  0.8s loss=2.340, TAw acc= 52.0% |
| Epoch  57, time=  1.7s | Train: skip eval | Valid: time=  0.4s loss=2.353, TAw acc= 49.8% |
| Epoch  58, time=  1.7s | Train: skip eval | Valid: time=  0.8s loss=2.332, TAw acc= 54.2% |
| Epoch  59, time=  1.8s | Train: skip eval | Valid: time=  0.6s loss=2.349, TAw acc= 52.6% |
| Epoch  60, time=  1.9s | Train: skip eval | Valid: time=  0.6s loss=2.364, TAw acc= 49.0% | lr=5.0e-02
| Epoch  61, time=  1.7s | Train: skip eval | Valid: time=  0.5s loss=2.339, TAw acc= 52.2% |
| Epoch  62, time=  1.8s | Train: skip eval | Valid: time=  0.7s loss=2.368, TAw acc= 49.4% |
| Epoch  63, time=  1.7s | Train: skip eval | Valid: time=  0.8s loss=2.379, TAw acc= 48.6% |
| Epoch  64, time=  1.9s | Train: skip eval | Valid: time=  1.5s loss=2.339, TAw acc= 52.4% |
| Epoch  65, time=  1.8s | Train: skip eval | Valid: time=  0.5s loss=2.343, TAw acc= 51.0% | lr=5.0e-02
| Epoch  66, time=  1.7s | Train: skip eval | Valid: time=  0.6s loss=2.376, TAw acc= 50.4% |
| Epoch  67, time=  1.8s | Train: skip eval | Valid: time=  0.6s loss=2.348, TAw acc= 50.2% |
| Epoch  68, time=  1.7s | Train: skip eval | Valid: time=  0.7s loss=2.354, TAw acc= 50.6% |
| Epoch  69, time=  1.8s | Train: skip eval | Valid: time=  0.7s loss=2.359, TAw acc= 51.8% |
| Epoch  70, time=  1.7s | Train: skip eval | Valid: time=  0.4s loss=2.389, TAw acc= 52.0% | lr=5.0e-02
| Epoch  71, time=  1.9s | Train: skip eval | Valid: time=  0.5s loss=2.364, TAw acc= 49.6% |
| Epoch  72, time=  1.8s | Train: skip eval | Valid: time=  0.5s loss=2.337, TAw acc= 51.8% |
| Epoch  73, time=  1.8s | Train: skip eval | Valid: time=  0.5s loss=2.366, TAw acc= 47.8% |
| Epoch  74, time=  2.9s | Train: skip eval | Valid: time=  0.8s loss=2.345, TAw acc= 52.0% |
| Epoch  75, time=  1.8s | Train: skip eval | Valid: time=  0.7s loss=2.331, TAw acc= 53.6% | lr=5.0e-02
| Epoch  76, time=  1.8s | Train: skip eval | Valid: time=  0.7s loss=2.367, TAw acc= 52.4% |
| Epoch  77, time=  2.0s | Train: skip eval | Valid: time=  0.7s loss=2.362, TAw acc= 49.2% |
| Epoch  78, time=  2.6s | Train: skip eval | Valid: time=  0.5s loss=2.331, TAw acc= 52.8% |
| Epoch  79, time=  1.8s | Train: skip eval | Valid: time=  0.6s loss=2.371, TAw acc= 49.6% |
| Epoch  80, time=  1.8s | Train: skip eval | Valid: time=  0.6s loss=2.388, TAw acc= 49.2% | lr=5.0e-02
| Epoch  81, time=  1.7s | Train: skip eval | Valid: time=  0.5s loss=2.358, TAw acc= 49.6% |
| Epoch  82, time=  1.8s | Train: skip eval | Valid: time=  1.2s loss=2.344, TAw acc= 52.4% |
| Epoch  83, time=  1.8s | Train: skip eval | Valid: time=  0.5s loss=2.330, TAw acc= 51.8% |
| Epoch  84, time=  1.8s | Train: skip eval | Valid: time=  0.5s loss=2.368, TAw acc= 50.0% |
| Epoch  85, time=  1.7s | Train: skip eval | Valid: time=  0.6s loss=2.394, TAw acc= 50.0% | lr=5.0e-02
| Epoch  86, time=  1.6s | Train: skip eval | Valid: time=  0.6s loss=2.357, TAw acc= 49.4% |
| Epoch  87, time=  1.7s | Train: skip eval | Valid: time=  0.7s loss=2.372, TAw acc= 51.0% |
| Epoch  88, time=  1.8s | Train: skip eval | Valid: time=  0.6s loss=2.368, TAw acc= 50.2% |
| Epoch  89, time=  1.7s | Train: skip eval | Valid: time=  0.5s loss=2.370, TAw acc= 51.0% |
| Epoch  90, time=  1.7s | Train: skip eval | Valid: time=  0.4s loss=2.376, TAw acc= 50.4% | lr=5.0e-02
| Epoch  91, time=  1.7s | Train: skip eval | Valid: time=  0.7s loss=2.336, TAw acc= 51.6% |
| Epoch  92, time=  2.7s | Train: skip eval | Valid: time=  0.7s loss=2.345, TAw acc= 51.8% |
| Epoch  93, time=  1.7s | Train: skip eval | Valid: time=  0.5s loss=2.345, TAw acc= 50.6% |
| Epoch  94, time=  1.7s | Train: skip eval | Valid: time=  0.5s loss=2.375, TAw acc= 49.2% |
| Epoch  95, time=  1.8s | Train: skip eval | Valid: time=  0.5s loss=2.345, TAw acc= 53.2% | lr=5.0e-02
| Epoch  96, time=  1.9s | Train: skip eval | Valid: time=  1.2s loss=2.363, TAw acc= 54.4% |
| Epoch  97, time=  1.8s | Train: skip eval | Valid: time=  0.7s loss=2.341, TAw acc= 51.4% |
| Epoch  98, time=  1.6s | Train: skip eval | Valid: time=  0.6s loss=2.367, TAw acc= 53.0% |
| Epoch  99, time=  1.7s | Train: skip eval | Valid: time=  0.8s loss=2.356, TAw acc= 50.6% |
| Epoch 100, time=  1.8s | Train: skip eval | Valid: time=  0.5s loss=2.361, TAw acc= 50.8% | lr=5.0e-02
Stage 2: Training bias correction layers
| Epoch  50, time=  0.5s | Train: loss=2.518, TAg acc= 29.3% |
| Epoch 100, time=  0.4s | Train: loss=2.537, TAg acc= 25.3% |
| Epoch 150, time=  0.4s | Train: loss=2.542, TAg acc= 33.3% |
| Epoch 200, time=  0.4s | Train: loss=2.631, TAg acc= 28.7% |
Stage 2: BiC training for Task 0: alpha=1.00000, beta=0.00000
Stage 2: BiC training for Task 1: alpha=0.71168, beta=-0.79590
Stage 2: BiC training for Task 2: alpha=0.53594, beta=-0.67303
| Selected 1350 train exemplars, time=  0.0s
------------------------------------------------------------------------------------------------------------
>>> Test on task  0 : loss=2.409 | TAw acc= 58.4%, forg= -0.8%| TAg acc= 42.0%, forg= 15.0% <<<
>>> Test on task  1 : loss=2.069 | TAw acc= 58.1%, forg=  1.6%| TAg acc= 42.2%, forg=  6.7% <<<
>>> Test on task  2 : loss=2.538 | TAw acc= 52.9%, forg=  0.0%| TAg acc= 29.3%, forg=  0.0% <<<
Save at ../miniimagenet_bic_result10t/miniimagenet_bic
************************************************************************************************************
Task  3
************************************************************************************************************
Stage 0: Select exemplars from validation
 > Selected 200 validation exemplars, time=  0.0s
Stage 1: Training model with distillation
| Epoch   1, time=  1.8s | Train: skip eval | Valid: time=  0.4s loss=2.831, TAw acc= 45.8% | *
| Epoch   2, time=  2.1s | Train: skip eval | Valid: time=  0.5s loss=2.810, TAw acc= 49.0% | *
| Epoch   3, time=  1.9s | Train: skip eval | Valid: time=  0.5s loss=2.800, TAw acc= 50.6% | *
| Epoch   4, time=  1.8s | Train: skip eval | Valid: time=  0.5s loss=2.801, TAw acc= 52.0% |
| Epoch   5, time=  1.9s | Train: skip eval | Valid: time=  0.6s loss=2.798, TAw acc= 54.0% | *
| Epoch   6, time=  2.0s | Train: skip eval | Valid: time=  0.5s loss=2.790, TAw acc= 53.4% | *
| Epoch   7, time=  2.0s | Train: skip eval | Valid: time=  0.6s loss=2.799, TAw acc= 53.8% |
| Epoch   8, time=  2.4s | Train: skip eval | Valid: time=  0.5s loss=2.786, TAw acc= 55.6% | *
| Epoch   9, time=  1.9s | Train: skip eval | Valid: time=  0.5s loss=2.794, TAw acc= 52.0% |
| Epoch  10, time=  2.0s | Train: skip eval | Valid: time=  0.6s loss=2.797, TAw acc= 54.6% |
| Epoch  11, time=  2.0s | Train: skip eval | Valid: time=  0.7s loss=2.790, TAw acc= 54.6% |
| Epoch  12, time=  1.9s | Train: skip eval | Valid: time=  0.5s loss=2.791, TAw acc= 55.0% |
| Epoch  13, time=  2.1s | Train: skip eval | Valid: time=  0.5s loss=2.783, TAw acc= 56.2% | *
| Epoch  14, time=  1.8s | Train: skip eval | Valid: time=  0.5s loss=2.787, TAw acc= 56.0% |
| Epoch  15, time=  1.8s | Train: skip eval | Valid: time=  0.6s loss=2.791, TAw acc= 54.0% |
| Epoch  16, time=  1.9s | Train: skip eval | Valid: time=  0.6s loss=2.792, TAw acc= 54.8% |
| Epoch  17, time=  2.3s | Train: skip eval | Valid: time=  0.7s loss=2.805, TAw acc= 55.6% |
| Epoch  18, time=  2.1s | Train: skip eval | Valid: time=  0.5s loss=2.813, TAw acc= 55.8% | lr=5.0e-02
| Epoch  19, time=  1.7s | Train: skip eval | Valid: time=  0.4s loss=2.800, TAw acc= 55.0% |
| Epoch  20, time=  1.9s | Train: skip eval | Valid: time=  0.6s loss=2.801, TAw acc= 56.4% |
| Epoch  21, time=  1.9s | Train: skip eval | Valid: time=  0.5s loss=2.801, TAw acc= 55.0% |
| Epoch  22, time=  1.8s | Train: skip eval | Valid: time=  0.5s loss=2.779, TAw acc= 56.0% | *
| Epoch  23, time=  1.7s | Train: skip eval | Valid: time=  0.6s loss=2.795, TAw acc= 55.4% |
| Epoch  24, time=  1.8s | Train: skip eval | Valid: time=  0.7s loss=2.799, TAw acc= 55.6% |
| Epoch  25, time=  1.7s | Train: skip eval | Valid: time=  0.7s loss=2.801, TAw acc= 52.6% |
| Epoch  26, time=  3.2s | Train: skip eval | Valid: time=  0.5s loss=2.813, TAw acc= 53.8% |
| Epoch  27, time=  1.9s | Train: skip eval | Valid: time=  0.8s loss=2.792, TAw acc= 56.4% | lr=5.0e-02
| Epoch  28, time=  2.0s | Train: skip eval | Valid: time=  0.6s loss=2.811, TAw acc= 56.0% |
| Epoch  29, time=  1.8s | Train: skip eval | Valid: time=  0.5s loss=2.791, TAw acc= 55.4% |
| Epoch  30, time=  2.0s | Train: skip eval | Valid: time=  0.5s loss=2.787, TAw acc= 56.2% |
| Epoch  31, time=  1.8s | Train: skip eval | Valid: time=  0.6s loss=2.790, TAw acc= 56.4% |
| Epoch  32, time=  2.1s | Train: skip eval | Valid: time=  0.5s loss=2.820, TAw acc= 52.8% | lr=5.0e-02
| Epoch  33, time=  2.1s | Train: skip eval | Valid: time=  0.5s loss=2.806, TAw acc= 56.2% |
| Epoch  34, time=  2.6s | Train: skip eval | Valid: time=  0.5s loss=2.785, TAw acc= 55.2% |
| Epoch  35, time=  1.9s | Train: skip eval | Valid: time=  0.5s loss=2.806, TAw acc= 53.6% |
| Epoch  36, time=  1.9s | Train: skip eval | Valid: time=  0.5s loss=2.792, TAw acc= 56.4% |
| Epoch  37, time=  1.8s | Train: skip eval | Valid: time=  0.5s loss=2.809, TAw acc= 53.4% | lr=5.0e-02
| Epoch  38, time=  1.8s | Train: skip eval | Valid: time=  0.5s loss=2.822, TAw acc= 55.0% |
| Epoch  39, time=  3.0s | Train: skip eval | Valid: time=  0.5s loss=2.826, TAw acc= 51.2% |
| Epoch  40, time=  1.8s | Train: skip eval | Valid: time=  0.6s loss=2.815, TAw acc= 54.2% |
| Epoch  41, time=  1.8s | Train: skip eval | Valid: time=  0.7s loss=2.814, TAw acc= 53.4% |
| Epoch  42, time=  2.0s | Train: skip eval | Valid: time=  0.5s loss=2.812, TAw acc= 54.6% | lr=5.0e-02
| Epoch  43, time=  2.1s | Train: skip eval | Valid: time=  0.5s loss=2.784, TAw acc= 55.0% |
| Epoch  44, time=  1.9s | Train: skip eval | Valid: time=  0.5s loss=2.810, TAw acc= 52.8% |
| Epoch  45, time=  2.0s | Train: skip eval | Valid: time=  0.5s loss=2.796, TAw acc= 55.0% |
| Epoch  46, time=  1.9s | Train: skip eval | Valid: time=  0.5s loss=2.800, TAw acc= 56.2% |
| Epoch  47, time=  1.9s | Train: skip eval | Valid: time=  0.4s loss=2.801, TAw acc= 54.6% | lr=5.0e-02
| Epoch  48, time=  2.3s | Train: skip eval | Valid: time=  0.5s loss=2.791, TAw acc= 54.8% |
| Epoch  49, time=  1.8s | Train: skip eval | Valid: time=  0.6s loss=2.800, TAw acc= 54.0% |
| Epoch  50, time=  1.7s | Train: skip eval | Valid: time=  0.5s loss=2.792, TAw acc= 55.2% |
| Epoch  51, time=  2.0s | Train: skip eval | Valid: time=  0.6s loss=2.801, TAw acc= 53.4% |
| Epoch  52, time=  2.4s | Train: skip eval | Valid: time=  0.5s loss=2.844, TAw acc= 53.6% | lr=5.0e-02
| Epoch  53, time=  1.9s | Train: skip eval | Valid: time=  0.6s loss=2.799, TAw acc= 56.6% |
| Epoch  54, time=  2.0s | Train: skip eval | Valid: time=  0.5s loss=2.818, TAw acc= 52.6% |
| Epoch  55, time=  1.8s | Train: skip eval | Valid: time=  0.6s loss=2.784, TAw acc= 57.6% |
| Epoch  56, time=  2.0s | Train: skip eval | Valid: time=  0.5s loss=2.794, TAw acc= 55.6% |
| Epoch  57, time=  2.5s | Train: skip eval | Valid: time=  0.5s loss=2.798, TAw acc= 55.4% | lr=5.0e-02
| Epoch  58, time=  1.9s | Train: skip eval | Valid: time=  0.5s loss=2.803, TAw acc= 58.2% |
| Epoch  59, time=  1.9s | Train: skip eval | Valid: time=  0.5s loss=2.796, TAw acc= 55.2% |
| Epoch  60, time=  1.9s | Train: skip eval | Valid: time=  0.5s loss=2.787, TAw acc= 56.6% |
| Epoch  61, time=  2.0s | Train: skip eval | Valid: time=  0.6s loss=2.799, TAw acc= 54.4% |
| Epoch  62, time=  2.1s | Train: skip eval | Valid: time=  0.5s loss=2.810, TAw acc= 56.2% | lr=5.0e-02
| Epoch  63, time=  1.8s | Train: skip eval | Valid: time=  0.5s loss=2.792, TAw acc= 55.8% |
| Epoch  64, time=  1.7s | Train: skip eval | Valid: time=  0.6s loss=2.807, TAw acc= 54.0% |
| Epoch  65, time=  1.9s | Train: skip eval | Valid: time=  0.5s loss=2.796, TAw acc= 55.0% |
| Epoch  66, time=  2.8s | Train: skip eval | Valid: time=  0.8s loss=2.794, TAw acc= 54.6% |
| Epoch  67, time=  1.7s | Train: skip eval | Valid: time=  0.5s loss=2.792, TAw acc= 55.0% | lr=5.0e-02
| Epoch  68, time=  1.9s | Train: skip eval | Valid: time=  0.5s loss=2.819, TAw acc= 54.6% |
| Epoch  69, time=  1.9s | Train: skip eval | Valid: time=  0.6s loss=2.792, TAw acc= 57.6% |
| Epoch  70, time=  1.8s | Train: skip eval | Valid: time=  0.4s loss=2.807, TAw acc= 56.6% |
| Epoch  71, time=  2.0s | Train: skip eval | Valid: time=  0.5s loss=2.816, TAw acc= 54.4% |
| Epoch  72, time=  2.0s | Train: skip eval | Valid: time=  0.6s loss=2.810, TAw acc= 56.2% | lr=5.0e-02
| Epoch  73, time=  1.8s | Train: skip eval | Valid: time=  0.5s loss=2.811, TAw acc= 55.0% |
| Epoch  74, time=  1.8s | Train: skip eval | Valid: time=  0.5s loss=2.789, TAw acc= 57.0% |
| Epoch  75, time=  2.4s | Train: skip eval | Valid: time=  0.6s loss=2.804, TAw acc= 52.8% |
| Epoch  76, time=  1.9s | Train: skip eval | Valid: time=  0.7s loss=2.797, TAw acc= 54.4% |
| Epoch  77, time=  1.8s | Train: skip eval | Valid: time=  0.6s loss=2.796, TAw acc= 55.2% | lr=5.0e-02
| Epoch  78, time=  1.8s | Train: skip eval | Valid: time=  0.5s loss=2.795, TAw acc= 54.8% |
| Epoch  79, time=  1.9s | Train: skip eval | Valid: time=  0.7s loss=2.820, TAw acc= 54.6% |
| Epoch  80, time=  1.9s | Train: skip eval | Valid: time=  0.5s loss=2.810, TAw acc= 54.0% |
| Epoch  81, time=  1.8s | Train: skip eval | Valid: time=  0.5s loss=2.807, TAw acc= 54.0% |
| Epoch  82, time=  1.8s | Train: skip eval | Valid: time=  0.5s loss=2.831, TAw acc= 55.2% | lr=5.0e-02
| Epoch  83, time=  1.9s | Train: skip eval | Valid: time=  0.5s loss=2.792, TAw acc= 55.6% |
| Epoch  84, time=  1.8s | Train: skip eval | Valid: time=  0.5s loss=2.800, TAw acc= 57.2% |
| Epoch  85, time=  1.8s | Train: skip eval | Valid: time=  0.5s loss=2.805, TAw acc= 55.6% |
| Epoch  86, time=  2.1s | Train: skip eval | Valid: time=  0.6s loss=2.801, TAw acc= 54.2% |
| Epoch  87, time=  2.0s | Train: skip eval | Valid: time=  0.5s loss=2.799, TAw acc= 54.8% | lr=5.0e-02
| Epoch  88, time=  1.9s | Train: skip eval | Valid: time=  1.2s loss=2.802, TAw acc= 54.8% |
| Epoch  89, time=  1.9s | Train: skip eval | Valid: time=  0.6s loss=2.809, TAw acc= 55.2% |
| Epoch  90, time=  1.8s | Train: skip eval | Valid: time=  0.6s loss=2.780, TAw acc= 56.6% |
| Epoch  91, time=  2.0s | Train: skip eval | Valid: time=  0.6s loss=2.810, TAw acc= 55.8% |
| Epoch  92, time=  2.0s | Train: skip eval | Valid: time=  0.5s loss=2.787, TAw acc= 56.4% | lr=5.0e-02
| Epoch  93, time=  2.7s | Train: skip eval | Valid: time=  0.5s loss=2.783, TAw acc= 58.4% |
| Epoch  94, time=  1.8s | Train: skip eval | Valid: time=  0.6s loss=2.790, TAw acc= 54.4% |
| Epoch  95, time=  2.0s | Train: skip eval | Valid: time=  0.5s loss=2.792, TAw acc= 56.2% |
| Epoch  96, time=  1.8s | Train: skip eval | Valid: time=  0.7s loss=2.794, TAw acc= 53.8% |
| Epoch  97, time=  2.0s | Train: skip eval | Valid: time=  0.6s loss=2.819, TAw acc= 55.0% | lr=5.0e-02
| Epoch  98, time=  1.9s | Train: skip eval | Valid: time=  0.6s loss=2.794, TAw acc= 56.6% |
| Epoch  99, time=  1.9s | Train: skip eval | Valid: time=  0.5s loss=2.834, TAw acc= 52.6% |
| Epoch 100, time=  1.9s | Train: skip eval | Valid: time=  0.5s loss=2.787, TAw acc= 56.6% |
Stage 2: Training bias correction layers
| Epoch  50, time=  0.4s | Train: loss=2.962, TAg acc= 23.5% |
| Epoch 100, time=  0.5s | Train: loss=3.051, TAg acc= 22.5% |
| Epoch 150, time=  0.4s | Train: loss=2.922, TAg acc= 24.5% |
| Epoch 200, time=  0.5s | Train: loss=2.845, TAg acc= 23.0% |
Stage 2: BiC training for Task 0: alpha=1.00000, beta=0.00000
Stage 2: BiC training for Task 1: alpha=0.71168, beta=-0.79590
Stage 2: BiC training for Task 2: alpha=0.53594, beta=-0.67303
Stage 2: BiC training for Task 3: alpha=0.47521, beta=-0.56372
| Selected 1800 train exemplars, time=  0.0s
------------------------------------------------------------------------------------------------------------
>>> Test on task  0 : loss=2.735 | TAw acc= 56.9%, forg=  1.5%| TAg acc= 36.2%, forg= 20.8% <<<
>>> Test on task  1 : loss=2.302 | TAw acc= 55.8%, forg=  3.9%| TAg acc= 38.2%, forg= 10.7% <<<
>>> Test on task  2 : loss=2.604 | TAw acc= 50.5%, forg=  2.4%| TAg acc= 28.0%, forg=  1.3% <<<
>>> Test on task  3 : loss=3.015 | TAw acc= 56.5%, forg=  0.0%| TAg acc= 25.5%, forg=  0.0% <<<
Save at ../miniimagenet_bic_result10t/miniimagenet_bic
************************************************************************************************************
Task  4
************************************************************************************************************
Stage 0: Select exemplars from validation
 > Selected 250 validation exemplars, time=  0.0s
Stage 1: Training model with distillation
| Epoch   1, time=  1.9s | Train: skip eval | Valid: time=  0.5s loss=3.123, TAw acc= 49.4% | *
| Epoch   2, time=  2.1s | Train: skip eval | Valid: time=  0.6s loss=3.109, TAw acc= 53.2% | *
| Epoch   3, time=  2.1s | Train: skip eval | Valid: time=  0.6s loss=3.109, TAw acc= 58.0% |
| Epoch   4, time=  1.9s | Train: skip eval | Valid: time=  0.5s loss=3.108, TAw acc= 57.6% | *
| Epoch   5, time=  2.0s | Train: skip eval | Valid: time=  0.5s loss=3.119, TAw acc= 56.6% |
| Epoch   6, time=  2.4s | Train: skip eval | Valid: time=  0.6s loss=3.123, TAw acc= 56.0% |
| Epoch   7, time=  2.0s | Train: skip eval | Valid: time=  0.5s loss=3.114, TAw acc= 57.0% |
| Epoch   8, time=  2.4s | Train: skip eval | Valid: time=  0.5s loss=3.135, TAw acc= 53.6% |
| Epoch   9, time=  2.0s | Train: skip eval | Valid: time=  0.5s loss=3.123, TAw acc= 58.4% | lr=5.0e-02
| Epoch  10, time=  2.0s | Train: skip eval | Valid: time=  0.5s loss=3.115, TAw acc= 58.6% |
| Epoch  11, time=  2.1s | Train: skip eval | Valid: time=  0.5s loss=3.104, TAw acc= 59.2% | *
| Epoch  12, time=  3.0s | Train: skip eval | Valid: time=  0.5s loss=3.121, TAw acc= 57.2% |
| Epoch  13, time=  2.1s | Train: skip eval | Valid: time=  0.5s loss=3.109, TAw acc= 59.0% |
| Epoch  14, time=  1.9s | Train: skip eval | Valid: time=  0.7s loss=3.118, TAw acc= 59.0% |
| Epoch  15, time=  1.9s | Train: skip eval | Valid: time=  0.5s loss=3.107, TAw acc= 58.0% |
| Epoch  16, time=  1.9s | Train: skip eval | Valid: time=  0.6s loss=3.115, TAw acc= 56.6% | lr=5.0e-02
| Epoch  17, time=  2.1s | Train: skip eval | Valid: time=  0.6s loss=3.111, TAw acc= 56.4% |
| Epoch  18, time=  2.1s | Train: skip eval | Valid: time=  0.5s loss=3.126, TAw acc= 54.8% |
| Epoch  19, time=  2.0s | Train: skip eval | Valid: time=  0.6s loss=3.119, TAw acc= 56.6% |
| Epoch  20, time=  2.0s | Train: skip eval | Valid: time=  1.3s loss=3.121, TAw acc= 55.8% |
| Epoch  21, time=  1.9s | Train: skip eval | Valid: time=  0.5s loss=3.110, TAw acc= 58.8% | lr=5.0e-02
| Epoch  22, time=  2.1s | Train: skip eval | Valid: time=  0.5s loss=3.120, TAw acc= 56.8% |
| Epoch  23, time=  1.9s | Train: skip eval | Valid: time=  0.5s loss=3.125, TAw acc= 58.4% |
| Epoch  24, time=  2.1s | Train: skip eval | Valid: time=  0.5s loss=3.106, TAw acc= 57.6% |
| Epoch  25, time=  2.8s | Train: skip eval | Valid: time=  0.6s loss=3.127, TAw acc= 55.4% |
| Epoch  26, time=  2.1s | Train: skip eval | Valid: time=  0.5s loss=3.120, TAw acc= 57.4% | lr=5.0e-02
| Epoch  27, time=  2.0s | Train: skip eval | Valid: time=  0.6s loss=3.114, TAw acc= 60.0% |
| Epoch  28, time=  2.0s | Train: skip eval | Valid: time=  1.7s loss=3.120, TAw acc= 56.8% |
| Epoch  29, time=  2.2s | Train: skip eval | Valid: time=  0.6s loss=3.128, TAw acc= 57.4% |
| Epoch  30, time=  2.0s | Train: skip eval | Valid: time=  0.5s loss=3.100, TAw acc= 58.8% | *
| Epoch  31, time=  2.1s | Train: skip eval | Valid: time=  0.5s loss=3.115, TAw acc= 59.6% |
| Epoch  32, time=  2.2s | Train: skip eval | Valid: time=  1.6s loss=3.103, TAw acc= 58.4% |
| Epoch  33, time=  2.1s | Train: skip eval | Valid: time=  0.5s loss=3.109, TAw acc= 58.0% |
| Epoch  34, time=  2.0s | Train: skip eval | Valid: time=  0.6s loss=3.103, TAw acc= 60.8% |
| Epoch  35, time=  2.3s | Train: skip eval | Valid: time=  0.6s loss=3.111, TAw acc= 60.4% | lr=5.0e-02
| Epoch  36, time=  2.0s | Train: skip eval | Valid: time=  1.2s loss=3.114, TAw acc= 58.8% |
| Epoch  37, time=  2.0s | Train: skip eval | Valid: time=  0.5s loss=3.125, TAw acc= 56.2% |
| Epoch  38, time=  2.0s | Train: skip eval | Valid: time=  0.6s loss=3.122, TAw acc= 59.2% |
| Epoch  39, time=  2.0s | Train: skip eval | Valid: time=  0.5s loss=3.136, TAw acc= 60.0% |
| Epoch  40, time=  2.1s | Train: skip eval | Valid: time=  1.3s loss=3.115, TAw acc= 60.2% | lr=5.0e-02
| Epoch  41, time=  2.1s | Train: skip eval | Valid: time=  0.5s loss=3.130, TAw acc= 56.8% |
| Epoch  42, time=  1.9s | Train: skip eval | Valid: time=  0.5s loss=3.121, TAw acc= 60.0% |
| Epoch  43, time=  1.9s | Train: skip eval | Valid: time=  0.5s loss=3.131, TAw acc= 56.8% |
| Epoch  44, time=  2.1s | Train: skip eval | Valid: time=  0.4s loss=3.111, TAw acc= 58.2% |
| Epoch  45, time=  2.7s | Train: skip eval | Valid: time=  0.6s loss=3.127, TAw acc= 55.4% | lr=5.0e-02
| Epoch  46, time=  2.2s | Train: skip eval | Valid: time=  0.5s loss=3.120, TAw acc= 58.4% |
| Epoch  47, time=  2.1s | Train: skip eval | Valid: time=  0.5s loss=3.120, TAw acc= 58.2% |
| Epoch  48, time=  1.9s | Train: skip eval | Valid: time=  0.8s loss=3.120, TAw acc= 60.0% |
| Epoch  49, time=  3.2s | Train: skip eval | Valid: time=  0.5s loss=3.121, TAw acc= 56.6% |
| Epoch  50, time=  2.2s | Train: skip eval | Valid: time=  0.5s loss=3.145, TAw acc= 54.8% | lr=5.0e-02
| Epoch  51, time=  2.0s | Train: skip eval | Valid: time=  0.5s loss=3.111, TAw acc= 59.4% |
| Epoch  52, time=  2.0s | Train: skip eval | Valid: time=  0.6s loss=3.124, TAw acc= 60.6% |
| Epoch  53, time=  2.6s | Train: skip eval | Valid: time=  0.6s loss=3.120, TAw acc= 60.2% |
| Epoch  54, time=  2.0s | Train: skip eval | Valid: time=  0.5s loss=3.119, TAw acc= 60.6% |
| Epoch  55, time=  2.1s | Train: skip eval | Valid: time=  0.4s loss=3.131, TAw acc= 60.2% | lr=5.0e-02
| Epoch  56, time=  2.0s | Train: skip eval | Valid: time=  0.5s loss=3.099, TAw acc= 59.8% | *
| Epoch  57, time=  2.1s | Train: skip eval | Valid: time=  0.5s loss=3.133, TAw acc= 57.0% |
| Epoch  58, time=  2.2s | Train: skip eval | Valid: time=  0.5s loss=3.125, TAw acc= 59.6% |
| Epoch  59, time=  2.0s | Train: skip eval | Valid: time=  0.6s loss=3.136, TAw acc= 56.4% |
| Epoch  60, time=  2.0s | Train: skip eval | Valid: time=  0.7s loss=3.128, TAw acc= 57.8% |
| Epoch  61, time=  2.1s | Train: skip eval | Valid: time=  0.7s loss=3.122, TAw acc= 57.8% | lr=5.0e-02
| Epoch  62, time=  1.9s | Train: skip eval | Valid: time=  0.7s loss=3.117, TAw acc= 58.0% |
| Epoch  63, time=  1.9s | Train: skip eval | Valid: time=  0.5s loss=3.119, TAw acc= 58.2% |
| Epoch  64, time=  2.0s | Train: skip eval | Valid: time=  0.5s loss=3.127, TAw acc= 57.8% |
| Epoch  65, time=  2.0s | Train: skip eval | Valid: time=  1.5s loss=3.114, TAw acc= 59.8% |
| Epoch  66, time=  2.1s | Train: skip eval | Valid: time=  0.7s loss=3.139, TAw acc= 56.6% | lr=5.0e-02
| Epoch  67, time=  2.0s | Train: skip eval | Valid: time=  0.6s loss=3.120, TAw acc= 58.4% |
| Epoch  68, time=  2.2s | Train: skip eval | Valid: time=  0.6s loss=3.135, TAw acc= 57.4% |
| Epoch  69, time=  1.9s | Train: skip eval | Valid: time=  1.4s loss=3.137, TAw acc= 56.8% |
| Epoch  70, time=  2.1s | Train: skip eval | Valid: time=  0.6s loss=3.125, TAw acc= 58.0% |
| Epoch  71, time=  2.1s | Train: skip eval | Valid: time=  0.5s loss=3.127, TAw acc= 57.6% | lr=5.0e-02
| Epoch  72, time=  1.9s | Train: skip eval | Valid: time=  0.5s loss=3.115, TAw acc= 58.8% |
| Epoch  73, time=  2.1s | Train: skip eval | Valid: time=  0.6s loss=3.121, TAw acc= 58.0% |
| Epoch  74, time=  2.6s | Train: skip eval | Valid: time=  0.7s loss=3.120, TAw acc= 59.8% |
| Epoch  75, time=  2.0s | Train: skip eval | Valid: time=  0.6s loss=3.116, TAw acc= 58.4% |
| Epoch  76, time=  1.9s | Train: skip eval | Valid: time=  0.5s loss=3.123, TAw acc= 56.6% | lr=5.0e-02
| Epoch  77, time=  2.0s | Train: skip eval | Valid: time=  0.6s loss=3.131, TAw acc= 55.6% |
| Epoch  78, time=  3.0s | Train: skip eval | Valid: time=  0.5s loss=3.117, TAw acc= 57.8% |
| Epoch  79, time=  2.1s | Train: skip eval | Valid: time=  0.6s loss=3.118, TAw acc= 58.2% |
| Epoch  80, time=  2.0s | Train: skip eval | Valid: time=  0.6s loss=3.120, TAw acc= 58.0% |
| Epoch  81, time=  1.8s | Train: skip eval | Valid: time=  0.5s loss=3.125, TAw acc= 59.2% | lr=5.0e-02
| Epoch  82, time=  2.8s | Train: skip eval | Valid: time=  0.5s loss=3.108, TAw acc= 60.4% |
| Epoch  83, time=  1.9s | Train: skip eval | Valid: time=  0.6s loss=3.135, TAw acc= 55.4% |
| Epoch  84, time=  2.0s | Train: skip eval | Valid: time=  0.5s loss=3.128, TAw acc= 56.4% |
| Epoch  85, time=  2.0s | Train: skip eval | Valid: time=  0.5s loss=3.138, TAw acc= 58.8% |
| Epoch  86, time=  2.1s | Train: skip eval | Valid: time=  0.5s loss=3.124, TAw acc= 59.0% | lr=5.0e-02
| Epoch  87, time=  2.3s | Train: skip eval | Valid: time=  0.5s loss=3.127, TAw acc= 59.4% |
| Epoch  88, time=  2.1s | Train: skip eval | Valid: time=  0.5s loss=3.124, TAw acc= 55.8% |
| Epoch  89, time=  2.2s | Train: skip eval | Valid: time=  0.6s loss=3.112, TAw acc= 61.0% |
| Epoch  90, time=  2.1s | Train: skip eval | Valid: time=  0.7s loss=3.134, TAw acc= 56.8% |
| Epoch  91, time=  2.1s | Train: skip eval | Valid: time=  0.6s loss=3.125, TAw acc= 61.0% | lr=5.0e-02
| Epoch  92, time=  2.1s | Train: skip eval | Valid: time=  0.5s loss=3.107, TAw acc= 60.4% |
| Epoch  93, time=  2.1s | Train: skip eval | Valid: time=  0.5s loss=3.132, TAw acc= 58.2% |
| Epoch  94, time=  1.9s | Train: skip eval | Valid: time=  1.4s loss=3.143, TAw acc= 57.4% |
| Epoch  95, time=  2.1s | Train: skip eval | Valid: time=  0.6s loss=3.121, TAw acc= 56.8% |
| Epoch  96, time=  2.1s | Train: skip eval | Valid: time=  0.6s loss=3.122, TAw acc= 58.6% | lr=5.0e-02
| Epoch  97, time=  2.0s | Train: skip eval | Valid: time=  0.6s loss=3.107, TAw acc= 59.2% |
| Epoch  98, time=  2.0s | Train: skip eval | Valid: time=  1.2s loss=3.128, TAw acc= 56.6% |
| Epoch  99, time=  1.9s | Train: skip eval | Valid: time=  0.7s loss=3.126, TAw acc= 57.2% |
| Epoch 100, time=  1.9s | Train: skip eval | Valid: time=  0.6s loss=3.137, TAw acc= 55.6% |
Stage 2: Training bias correction layers
| Epoch  50, time=  0.5s | Train: loss=3.085, TAg acc= 22.4% |
| Epoch 100, time=  0.4s | Train: loss=3.128, TAg acc= 19.6% |
| Epoch 150, time=  0.4s | Train: loss=3.076, TAg acc= 22.8% |
| Epoch 200, time=  0.4s | Train: loss=3.037, TAg acc= 26.0% |
Stage 2: BiC training for Task 0: alpha=1.00000, beta=0.00000
Stage 2: BiC training for Task 1: alpha=0.71168, beta=-0.79590
Stage 2: BiC training for Task 2: alpha=0.53594, beta=-0.67303
Stage 2: BiC training for Task 3: alpha=0.47521, beta=-0.56372
Stage 2: BiC training for Task 4: alpha=0.59652, beta=-0.69435
| Selected 2250 train exemplars, time=  0.1s
------------------------------------------------------------------------------------------------------------
>>> Test on task  0 : loss=3.101 | TAw acc= 56.9%, forg=  1.5%| TAg acc= 30.8%, forg= 26.2% <<<
>>> Test on task  1 : loss=2.591 | TAw acc= 54.5%, forg=  5.2%| TAg acc= 31.8%, forg= 17.1% <<<
>>> Test on task  2 : loss=2.716 | TAw acc= 53.6%, forg= -0.7%| TAg acc= 26.8%, forg=  2.5% <<<
>>> Test on task  3 : loss=3.007 | TAw acc= 55.2%, forg=  1.3%| TAg acc= 21.1%, forg=  4.4% <<<
>>> Test on task  4 : loss=3.234 | TAw acc= 59.3%, forg=  0.0%| TAg acc= 34.2%, forg=  0.0% <<<
Save at ../miniimagenet_bic_result10t/miniimagenet_bic
************************************************************************************************************
Task  5
************************************************************************************************************
Stage 0: Select exemplars from validation
 > Selected 300 validation exemplars, time=  0.0s
Stage 1: Training model with distillation
| Epoch   1, time=  2.3s | Train: skip eval | Valid: time=  0.5s loss=3.367, TAw acc= 46.6% | *
| Epoch   2, time=  2.1s | Train: skip eval | Valid: time=  0.6s loss=3.367, TAw acc= 45.2% | *
| Epoch   3, time=  2.1s | Train: skip eval | Valid: time=  0.6s loss=3.362, TAw acc= 48.6% | *
| Epoch   4, time=  2.2s | Train: skip eval | Valid: time=  0.5s loss=3.347, TAw acc= 51.4% | *
| Epoch   5, time=  2.1s | Train: skip eval | Valid: time=  0.5s loss=3.374, TAw acc= 48.4% |
| Epoch   6, time=  2.1s | Train: skip eval | Valid: time=  0.6s loss=3.350, TAw acc= 52.6% |
| Epoch   7, time=  2.2s | Train: skip eval | Valid: time=  1.5s loss=3.348, TAw acc= 52.8% |
| Epoch   8, time=  2.1s | Train: skip eval | Valid: time=  0.7s loss=3.351, TAw acc= 53.4% |
| Epoch   9, time=  2.3s | Train: skip eval | Valid: time=  0.5s loss=3.351, TAw acc= 55.0% | lr=5.0e-02
| Epoch  10, time=  2.1s | Train: skip eval | Valid: time=  0.6s loss=3.368, TAw acc= 49.2% |
| Epoch  11, time=  2.2s | Train: skip eval | Valid: time=  0.8s loss=3.362, TAw acc= 51.4% |
| Epoch  12, time=  2.2s | Train: skip eval | Valid: time=  0.5s loss=3.358, TAw acc= 51.0% |
| Epoch  13, time=  2.2s | Train: skip eval | Valid: time=  0.8s loss=3.356, TAw acc= 52.6% |
| Epoch  14, time=  2.2s | Train: skip eval | Valid: time=  0.6s loss=3.362, TAw acc= 53.8% | lr=5.0e-02
| Epoch  15, time=  2.1s | Train: skip eval | Valid: time=  0.5s loss=3.351, TAw acc= 52.8% |
| Epoch  16, time=  2.2s | Train: skip eval | Valid: time=  0.5s loss=3.360, TAw acc= 52.2% |
| Epoch  17, time=  2.2s | Train: skip eval | Valid: time=  0.5s loss=3.365, TAw acc= 53.4% |
| Epoch  18, time=  2.1s | Train: skip eval | Valid: time=  0.5s loss=3.358, TAw acc= 51.8% |
| Epoch  19, time=  2.1s | Train: skip eval | Valid: time=  1.0s loss=3.366, TAw acc= 51.4% | lr=5.0e-02
| Epoch  20, time=  2.1s | Train: skip eval | Valid: time=  0.7s loss=3.362, TAw acc= 48.6% |
| Epoch  21, time=  2.1s | Train: skip eval | Valid: time=  0.5s loss=3.349, TAw acc= 51.0% |
| Epoch  22, time=  2.2s | Train: skip eval | Valid: time=  0.7s loss=3.360, TAw acc= 53.4% |
| Epoch  23, time=  2.2s | Train: skip eval | Valid: time=  1.1s loss=3.358, TAw acc= 51.6% |
| Epoch  24, time=  2.2s | Train: skip eval | Valid: time=  0.5s loss=3.346, TAw acc= 53.2% | *
| Epoch  25, time=  2.2s | Train: skip eval | Valid: time=  0.5s loss=3.348, TAw acc= 53.4% |
| Epoch  26, time=  2.2s | Train: skip eval | Valid: time=  0.5s loss=3.344, TAw acc= 55.6% | *
| Epoch  27, time=  2.1s | Train: skip eval | Valid: time=  1.2s loss=3.365, TAw acc= 55.6% |
| Epoch  28, time=  2.3s | Train: skip eval | Valid: time=  0.5s loss=3.353, TAw acc= 54.0% |
| Epoch  29, time=  2.1s | Train: skip eval | Valid: time=  0.6s loss=3.372, TAw acc= 53.0% |
| Epoch  30, time=  2.2s | Train: skip eval | Valid: time=  0.6s loss=3.365, TAw acc= 52.8% |
| Epoch  31, time=  2.3s | Train: skip eval | Valid: time=  0.5s loss=3.353, TAw acc= 53.8% | lr=5.0e-02
| Epoch  32, time=  2.2s | Train: skip eval | Valid: time=  0.5s loss=3.360, TAw acc= 52.8% |
| Epoch  33, time=  2.1s | Train: skip eval | Valid: time=  0.6s loss=3.356, TAw acc= 54.8% |
| Epoch  34, time=  2.2s | Train: skip eval | Valid: time=  0.6s loss=3.371, TAw acc= 53.0% |
| Epoch  35, time=  2.2s | Train: skip eval | Valid: time=  1.0s loss=3.386, TAw acc= 52.0% |
| Epoch  36, time=  2.2s | Train: skip eval | Valid: time=  0.5s loss=3.363, TAw acc= 54.8% | lr=5.0e-02
| Epoch  37, time=  2.1s | Train: skip eval | Valid: time=  0.5s loss=3.369, TAw acc= 54.2% |
| Epoch  38, time=  2.1s | Train: skip eval | Valid: time=  0.5s loss=3.352, TAw acc= 55.2% |
| Epoch  39, time=  2.0s | Train: skip eval | Valid: time=  1.4s loss=3.361, TAw acc= 54.2% |
| Epoch  40, time=  2.3s | Train: skip eval | Valid: time=  0.5s loss=3.362, TAw acc= 55.4% |
| Epoch  41, time=  2.3s | Train: skip eval | Valid: time=  0.5s loss=3.349, TAw acc= 55.6% | lr=5.0e-02
| Epoch  42, time=  2.2s | Train: skip eval | Valid: time=  0.5s loss=3.368, TAw acc= 52.4% |
| Epoch  43, time=  2.5s | Train: skip eval | Valid: time=  0.5s loss=3.361, TAw acc= 55.0% |
| Epoch  44, time=  2.1s | Train: skip eval | Valid: time=  0.6s loss=3.371, TAw acc= 53.6% |
| Epoch  45, time=  2.3s | Train: skip eval | Valid: time=  0.5s loss=3.366, TAw acc= 54.6% |
| Epoch  46, time=  2.4s | Train: skip eval | Valid: time=  0.4s loss=3.355, TAw acc= 56.0% | lr=5.0e-02
| Epoch  47, time=  2.0s | Train: skip eval | Valid: time=  1.1s loss=3.355, TAw acc= 55.0% |
| Epoch  48, time=  2.2s | Train: skip eval | Valid: time=  0.5s loss=3.376, TAw acc= 52.4% |
| Epoch  49, time=  2.1s | Train: skip eval | Valid: time=  0.5s loss=3.379, TAw acc= 49.0% |
| Epoch  50, time=  2.2s | Train: skip eval | Valid: time=  0.6s loss=3.351, TAw acc= 55.6% |
| Epoch  51, time=  2.3s | Train: skip eval | Valid: time=  1.0s loss=3.374, TAw acc= 51.4% | lr=5.0e-02
| Epoch  52, time=  2.1s | Train: skip eval | Valid: time=  0.5s loss=3.347, TAw acc= 55.0% |
| Epoch  53, time=  2.2s | Train: skip eval | Valid: time=  0.6s loss=3.368, TAw acc= 53.2% |
| Epoch  54, time=  2.3s | Train: skip eval | Valid: time=  0.5s loss=3.364, TAw acc= 53.2% |
| Epoch  55, time=  2.1s | Train: skip eval | Valid: time=  1.1s loss=3.363, TAw acc= 57.8% |
| Epoch  56, time=  2.1s | Train: skip eval | Valid: time=  0.6s loss=3.353, TAw acc= 56.6% | lr=5.0e-02
| Epoch  57, time=  2.0s | Train: skip eval | Valid: time=  0.7s loss=3.363, TAw acc= 53.8% |
| Epoch  58, time=  2.4s | Train: skip eval | Valid: time=  0.5s loss=3.347, TAw acc= 56.2% |
| Epoch  59, time=  2.2s | Train: skip eval | Valid: time=  1.0s loss=3.368, TAw acc= 57.0% |
| Epoch  60, time=  2.3s | Train: skip eval | Valid: time=  0.5s loss=3.392, TAw acc= 53.6% |
| Epoch  61, time=  2.1s | Train: skip eval | Valid: time=  0.6s loss=3.358, TAw acc= 53.6% | lr=5.0e-02
| Epoch  62, time=  2.1s | Train: skip eval | Valid: time=  0.6s loss=3.362, TAw acc= 53.2% |
| Epoch  63, time=  2.1s | Train: skip eval | Valid: time=  1.2s loss=3.351, TAw acc= 54.6% |
| Epoch  64, time=  2.4s | Train: skip eval | Valid: time=  0.6s loss=3.361, TAw acc= 54.0% |
| Epoch  65, time=  2.1s | Train: skip eval | Valid: time=  0.6s loss=3.371, TAw acc= 55.6% |
| Epoch  66, time=  2.1s | Train: skip eval | Valid: time=  0.4s loss=3.366, TAw acc= 54.2% | lr=5.0e-02
| Epoch  67, time=  2.2s | Train: skip eval | Valid: time=  0.9s loss=3.362, TAw acc= 53.0% |
| Epoch  68, time=  2.1s | Train: skip eval | Valid: time=  0.6s loss=3.337, TAw acc= 55.0% | *
| Epoch  69, time=  2.0s | Train: skip eval | Valid: time=  0.5s loss=3.367, TAw acc= 55.0% |
| Epoch  70, time=  2.2s | Train: skip eval | Valid: time=  0.5s loss=3.360, TAw acc= 54.4% |
| Epoch  71, time=  2.1s | Train: skip eval | Valid: time=  1.4s loss=3.344, TAw acc= 53.8% |
| Epoch  72, time=  2.0s | Train: skip eval | Valid: time=  0.8s loss=3.358, TAw acc= 55.4% |
| Epoch  73, time=  2.2s | Train: skip eval | Valid: time=  0.6s loss=3.368, TAw acc= 56.8% | lr=5.0e-02
| Epoch  74, time=  2.1s | Train: skip eval | Valid: time=  0.5s loss=3.362, TAw acc= 53.4% |
| Epoch  75, time=  2.2s | Train: skip eval | Valid: time=  1.0s loss=3.386, TAw acc= 54.6% |
| Epoch  76, time=  2.0s | Train: skip eval | Valid: time=  0.5s loss=3.368, TAw acc= 51.0% |
| Epoch  77, time=  2.2s | Train: skip eval | Valid: time=  0.5s loss=3.370, TAw acc= 53.6% |
| Epoch  78, time=  2.3s | Train: skip eval | Valid: time=  0.6s loss=3.366, TAw acc= 53.6% | lr=5.0e-02
| Epoch  79, time=  2.0s | Train: skip eval | Valid: time=  1.2s loss=3.359, TAw acc= 54.4% |
| Epoch  80, time=  2.3s | Train: skip eval | Valid: time=  0.4s loss=3.367, TAw acc= 56.8% |
| Epoch  81, time=  2.1s | Train: skip eval | Valid: time=  0.5s loss=3.372, TAw acc= 55.4% |
| Epoch  82, time=  2.1s | Train: skip eval | Valid: time=  0.6s loss=3.388, TAw acc= 50.2% |
| Epoch  83, time=  2.1s | Train: skip eval | Valid: time=  1.1s loss=3.369, TAw acc= 53.4% | lr=5.0e-02
| Epoch  84, time=  2.2s | Train: skip eval | Valid: time=  0.5s loss=3.363, TAw acc= 53.6% |
| Epoch  85, time=  2.1s | Train: skip eval | Valid: time=  0.5s loss=3.366, TAw acc= 53.8% |
| Epoch  86, time=  2.0s | Train: skip eval | Valid: time=  0.5s loss=3.357, TAw acc= 54.8% |
| Epoch  87, time=  2.3s | Train: skip eval | Valid: time=  1.0s loss=3.360, TAw acc= 54.2% |
| Epoch  88, time=  2.3s | Train: skip eval | Valid: time=  0.5s loss=3.381, TAw acc= 55.0% | lr=5.0e-02
| Epoch  89, time=  2.0s | Train: skip eval | Valid: time=  0.4s loss=3.357, TAw acc= 56.2% |
| Epoch  90, time=  1.9s | Train: skip eval | Valid: time=  0.6s loss=3.363, TAw acc= 53.4% |
| Epoch  91, time=  2.1s | Train: skip eval | Valid: time=  1.4s loss=3.386, TAw acc= 52.8% |
| Epoch  92, time=  2.1s | Train: skip eval | Valid: time=  0.5s loss=3.361, TAw acc= 55.6% |
| Epoch  93, time=  2.2s | Train: skip eval | Valid: time=  0.5s loss=3.365, TAw acc= 55.0% | lr=5.0e-02
| Epoch  94, time=  2.2s | Train: skip eval | Valid: time=  0.6s loss=3.369, TAw acc= 54.0% |
| Epoch  95, time=  2.3s | Train: skip eval | Valid: time=  1.0s loss=3.369, TAw acc= 54.4% |
| Epoch  96, time=  2.0s | Train: skip eval | Valid: time=  0.6s loss=3.373, TAw acc= 55.2% |
| Epoch  97, time=  2.1s | Train: skip eval | Valid: time=  0.7s loss=3.367, TAw acc= 54.2% |
| Epoch  98, time=  2.2s | Train: skip eval | Valid: time=  0.7s loss=3.373, TAw acc= 54.0% | lr=5.0e-02
| Epoch  99, time=  2.1s | Train: skip eval | Valid: time=  0.9s loss=3.360, TAw acc= 51.4% |
| Epoch 100, time=  2.1s | Train: skip eval | Valid: time=  0.6s loss=3.365, TAw acc= 55.0% |
Stage 2: Training bias correction layers
| Epoch  50, time=  0.5s | Train: loss=3.031, TAg acc= 24.0% |
| Epoch 100, time=  0.4s | Train: loss=3.165, TAg acc= 22.7% |
| Epoch 150, time=  0.4s | Train: loss=3.169, TAg acc= 22.0% |
| Epoch 200, time=  0.7s | Train: loss=3.247, TAg acc= 24.3% |
Stage 2: BiC training for Task 0: alpha=1.00000, beta=0.00000
Stage 2: BiC training for Task 1: alpha=0.71168, beta=-0.79590
Stage 2: BiC training for Task 2: alpha=0.53594, beta=-0.67303
Stage 2: BiC training for Task 3: alpha=0.47521, beta=-0.56372
Stage 2: BiC training for Task 4: alpha=0.59652, beta=-0.69435
Stage 2: BiC training for Task 5: alpha=0.55322, beta=-0.57669
| Selected 2700 train exemplars, time=  0.1s
------------------------------------------------------------------------------------------------------------
>>> Test on task  0 : loss=3.229 | TAw acc= 55.2%, forg=  3.2%| TAg acc= 32.6%, forg= 24.4% <<<
>>> Test on task  1 : loss=2.767 | TAw acc= 54.7%, forg=  5.0%| TAg acc= 31.7%, forg= 17.2% <<<
>>> Test on task  2 : loss=2.872 | TAw acc= 53.1%, forg=  0.5%| TAg acc= 25.8%, forg=  3.5% <<<
>>> Test on task  3 : loss=3.036 | TAw acc= 55.5%, forg=  1.0%| TAg acc= 21.6%, forg=  3.9% <<<
>>> Test on task  4 : loss=3.142 | TAw acc= 59.4%, forg= -0.1%| TAg acc= 28.8%, forg=  5.4% <<<
>>> Test on task  5 : loss=3.461 | TAw acc= 57.9%, forg=  0.0%| TAg acc= 31.1%, forg=  0.0% <<<
Save at ../miniimagenet_bic_result10t/miniimagenet_bic
************************************************************************************************************
Task  6
************************************************************************************************************
Stage 0: Select exemplars from validation
 > Selected 350 validation exemplars, time=  0.0s
Stage 1: Training model with distillation
| Epoch   1, time=  2.2s | Train: skip eval | Valid: time=  0.7s loss=3.536, TAw acc= 55.6% | *
| Epoch   2, time=  2.3s | Train: skip eval | Valid: time=  0.5s loss=3.532, TAw acc= 57.6% | *
| Epoch   3, time=  2.5s | Train: skip eval | Valid: time=  0.7s loss=3.528, TAw acc= 59.2% | *
| Epoch   4, time=  2.1s | Train: skip eval | Valid: time=  0.5s loss=3.522, TAw acc= 57.8% | *
| Epoch   5, time=  2.5s | Train: skip eval | Valid: time=  0.5s loss=3.526, TAw acc= 58.2% |
| Epoch   6, time=  2.4s | Train: skip eval | Valid: time=  0.6s loss=3.517, TAw acc= 60.2% | *
| Epoch   7, time=  2.2s | Train: skip eval | Valid: time=  0.5s loss=3.535, TAw acc= 61.8% |
| Epoch   8, time=  2.2s | Train: skip eval | Valid: time=  0.6s loss=3.521, TAw acc= 58.0% |
| Epoch   9, time=  2.3s | Train: skip eval | Valid: time=  0.6s loss=3.531, TAw acc= 58.6% |
| Epoch  10, time=  2.3s | Train: skip eval | Valid: time=  0.6s loss=3.528, TAw acc= 60.6% |
| Epoch  11, time=  2.3s | Train: skip eval | Valid: time=  0.5s loss=3.540, TAw acc= 60.4% | lr=5.0e-02
| Epoch  12, time=  2.1s | Train: skip eval | Valid: time=  0.6s loss=3.528, TAw acc= 59.0% |
| Epoch  13, time=  2.2s | Train: skip eval | Valid: time=  0.5s loss=3.529, TAw acc= 58.8% |
| Epoch  14, time=  2.5s | Train: skip eval | Valid: time=  0.5s loss=3.536, TAw acc= 57.0% |
| Epoch  15, time=  2.8s | Train: skip eval | Valid: time=  0.5s loss=3.517, TAw acc= 61.4% | *
| Epoch  16, time=  2.2s | Train: skip eval | Valid: time=  0.5s loss=3.521, TAw acc= 61.8% |
| Epoch  17, time=  2.4s | Train: skip eval | Valid: time=  0.5s loss=3.538, TAw acc= 59.6% |
| Epoch  18, time=  2.2s | Train: skip eval | Valid: time=  0.5s loss=3.516, TAw acc= 62.0% | *
| Epoch  19, time=  2.2s | Train: skip eval | Valid: time=  0.5s loss=3.531, TAw acc= 61.8% |
| Epoch  20, time=  2.3s | Train: skip eval | Valid: time=  0.6s loss=3.527, TAw acc= 61.6% |
| Epoch  21, time=  2.2s | Train: skip eval | Valid: time=  0.5s loss=3.533, TAw acc= 61.6% |
| Epoch  22, time=  2.3s | Train: skip eval | Valid: time=  0.5s loss=3.533, TAw acc= 60.8% |
| Epoch  23, time=  2.3s | Train: skip eval | Valid: time=  0.7s loss=3.535, TAw acc= 61.0% | lr=5.0e-02
| Epoch  24, time=  2.3s | Train: skip eval | Valid: time=  0.6s loss=3.552, TAw acc= 58.0% |
| Epoch  25, time=  2.3s | Train: skip eval | Valid: time=  0.5s loss=3.539, TAw acc= 58.0% |
| Epoch  26, time=  2.3s | Train: skip eval | Valid: time=  0.7s loss=3.529, TAw acc= 58.8% |
| Epoch  27, time=  2.4s | Train: skip eval | Valid: time=  0.8s loss=3.531, TAw acc= 59.4% |
| Epoch  28, time=  2.2s | Train: skip eval | Valid: time=  0.6s loss=3.537, TAw acc= 59.4% | lr=5.0e-02
| Epoch  29, time=  2.3s | Train: skip eval | Valid: time=  0.5s loss=3.537, TAw acc= 62.0% |
| Epoch  30, time=  2.3s | Train: skip eval | Valid: time=  0.5s loss=3.535, TAw acc= 58.6% |
| Epoch  31, time=  2.8s | Train: skip eval | Valid: time=  0.5s loss=3.525, TAw acc= 61.6% |
| Epoch  32, time=  2.5s | Train: skip eval | Valid: time=  0.6s loss=3.534, TAw acc= 61.8% |
| Epoch  33, time=  2.4s | Train: skip eval | Valid: time=  0.5s loss=3.552, TAw acc= 60.6% | lr=5.0e-02
| Epoch  34, time=  2.3s | Train: skip eval | Valid: time=  0.5s loss=3.537, TAw acc= 61.6% |
| Epoch  35, time=  2.4s | Train: skip eval | Valid: time=  0.5s loss=3.528, TAw acc= 62.6% |
| Epoch  36, time=  2.2s | Train: skip eval | Valid: time=  0.5s loss=3.543, TAw acc= 60.8% |
| Epoch  37, time=  2.3s | Train: skip eval | Valid: time=  0.7s loss=3.539, TAw acc= 60.4% |
| Epoch  38, time=  2.2s | Train: skip eval | Valid: time=  0.6s loss=3.536, TAw acc= 61.2% | lr=5.0e-02
| Epoch  39, time=  2.3s | Train: skip eval | Valid: time=  0.6s loss=3.524, TAw acc= 61.8% |
| Epoch  40, time=  2.3s | Train: skip eval | Valid: time=  0.6s loss=3.523, TAw acc= 63.4% |
| Epoch  41, time=  2.5s | Train: skip eval | Valid: time=  0.5s loss=3.526, TAw acc= 60.2% |
| Epoch  42, time=  2.4s | Train: skip eval | Valid: time=  0.6s loss=3.543, TAw acc= 60.0% |
| Epoch  43, time=  3.2s | Train: skip eval | Valid: time=  0.6s loss=3.536, TAw acc= 62.4% | lr=5.0e-02
| Epoch  44, time=  2.2s | Train: skip eval | Valid: time=  0.5s loss=3.533, TAw acc= 61.0% |
| Epoch  45, time=  2.4s | Train: skip eval | Valid: time=  0.5s loss=3.539, TAw acc= 59.8% |
| Epoch  46, time=  2.2s | Train: skip eval | Valid: time=  1.1s loss=3.522, TAw acc= 63.0% |
| Epoch  47, time=  2.1s | Train: skip eval | Valid: time=  0.6s loss=3.534, TAw acc= 60.0% |
| Epoch  48, time=  2.1s | Train: skip eval | Valid: time=  0.5s loss=3.546, TAw acc= 61.8% | lr=5.0e-02
| Epoch  49, time=  2.2s | Train: skip eval | Valid: time=  0.5s loss=3.529, TAw acc= 60.4% |
| Epoch  50, time=  2.3s | Train: skip eval | Valid: time=  1.4s loss=3.534, TAw acc= 60.2% |
| Epoch  51, time=  2.4s | Train: skip eval | Valid: time=  0.4s loss=3.528, TAw acc= 63.6% |
| Epoch  52, time=  2.4s | Train: skip eval | Valid: time=  0.5s loss=3.539, TAw acc= 60.8% |
| Epoch  53, time=  2.2s | Train: skip eval | Valid: time=  0.5s loss=3.539, TAw acc= 58.8% | lr=5.0e-02
| Epoch  54, time=  2.4s | Train: skip eval | Valid: time=  0.5s loss=3.517, TAw acc= 61.0% |
| Epoch  55, time=  2.6s | Train: skip eval | Valid: time=  0.5s loss=3.526, TAw acc= 62.8% |
| Epoch  56, time=  2.3s | Train: skip eval | Valid: time=  0.5s loss=3.531, TAw acc= 62.2% |
| Epoch  57, time=  2.3s | Train: skip eval | Valid: time=  0.7s loss=3.536, TAw acc= 60.2% |
| Epoch  58, time=  3.0s | Train: skip eval | Valid: time=  0.4s loss=3.533, TAw acc= 62.2% | lr=5.0e-02
| Epoch  59, time=  2.5s | Train: skip eval | Valid: time=  0.5s loss=3.531, TAw acc= 60.4% |
| Epoch  60, time=  2.2s | Train: skip eval | Valid: time=  0.7s loss=3.540, TAw acc= 60.6% |
| Epoch  61, time=  2.3s | Train: skip eval | Valid: time=  0.6s loss=3.552, TAw acc= 58.6% |
| Epoch  62, time=  2.9s | Train: skip eval | Valid: time=  0.6s loss=3.549, TAw acc= 60.2% |
| Epoch  63, time=  2.2s | Train: skip eval | Valid: time=  0.7s loss=3.539, TAw acc= 59.2% | lr=5.0e-02
| Epoch  64, time=  2.5s | Train: skip eval | Valid: time=  0.5s loss=3.526, TAw acc= 62.2% |
| Epoch  65, time=  2.3s | Train: skip eval | Valid: time=  0.7s loss=3.526, TAw acc= 62.6% |
| Epoch  66, time=  2.1s | Train: skip eval | Valid: time=  0.6s loss=3.541, TAw acc= 59.4% |
| Epoch  67, time=  2.3s | Train: skip eval | Valid: time=  0.6s loss=3.537, TAw acc= 60.4% |
| Epoch  68, time=  2.2s | Train: skip eval | Valid: time=  0.5s loss=3.530, TAw acc= 60.0% | lr=5.0e-02
| Epoch  69, time=  2.3s | Train: skip eval | Valid: time=  1.1s loss=3.526, TAw acc= 61.0% |
| Epoch  70, time=  2.3s | Train: skip eval | Valid: time=  0.6s loss=3.530, TAw acc= 57.4% |
| Epoch  71, time=  2.3s | Train: skip eval | Valid: time=  0.6s loss=3.540, TAw acc= 60.0% |
| Epoch  72, time=  2.3s | Train: skip eval | Valid: time=  0.7s loss=3.538, TAw acc= 58.4% |
| Epoch  73, time=  2.6s | Train: skip eval | Valid: time=  0.5s loss=3.561, TAw acc= 58.8% | lr=5.0e-02
| Epoch  74, time=  2.2s | Train: skip eval | Valid: time=  0.6s loss=3.537, TAw acc= 58.4% |
| Epoch  75, time=  2.6s | Train: skip eval | Valid: time=  0.6s loss=3.531, TAw acc= 59.6% |
| Epoch  76, time=  2.4s | Train: skip eval | Valid: time=  0.5s loss=3.544, TAw acc= 59.6% |
| Epoch  77, time=  2.1s | Train: skip eval | Valid: time=  0.6s loss=3.540, TAw acc= 58.6% |
| Epoch  78, time=  2.4s | Train: skip eval | Valid: time=  0.5s loss=3.538, TAw acc= 60.4% | lr=5.0e-02
| Epoch  79, time=  2.3s | Train: skip eval | Valid: time=  0.7s loss=3.523, TAw acc= 61.8% |
| Epoch  80, time=  2.4s | Train: skip eval | Valid: time=  0.5s loss=3.519, TAw acc= 61.2% |
| Epoch  81, time=  2.5s | Train: skip eval | Valid: time=  0.6s loss=3.536, TAw acc= 56.2% |
| Epoch  82, time=  2.5s | Train: skip eval | Valid: time=  0.5s loss=3.539, TAw acc= 60.0% |
| Epoch  83, time=  2.2s | Train: skip eval | Valid: time=  0.6s loss=3.533, TAw acc= 62.0% | lr=5.0e-02
| Epoch  84, time=  2.3s | Train: skip eval | Valid: time=  0.6s loss=3.525, TAw acc= 59.6% |
| Epoch  85, time=  3.3s | Train: skip eval | Valid: time=  0.6s loss=3.531, TAw acc= 60.2% |
| Epoch  86, time=  2.3s | Train: skip eval | Valid: time=  0.6s loss=3.527, TAw acc= 62.8% |
| Epoch  87, time=  2.3s | Train: skip eval | Valid: time=  0.5s loss=3.550, TAw acc= 55.8% |
| Epoch  88, time=  2.3s | Train: skip eval | Valid: time=  1.2s loss=3.532, TAw acc= 61.0% | lr=5.0e-02
| Epoch  89, time=  2.3s | Train: skip eval | Valid: time=  0.5s loss=3.528, TAw acc= 61.2% |
| Epoch  90, time=  2.3s | Train: skip eval | Valid: time=  0.6s loss=3.533, TAw acc= 60.2% |
| Epoch  91, time=  2.4s | Train: skip eval | Valid: time=  0.5s loss=3.549, TAw acc= 59.4% |
| Epoch  92, time=  2.3s | Train: skip eval | Valid: time=  0.7s loss=3.538, TAw acc= 59.8% |
| Epoch  93, time=  2.4s | Train: skip eval | Valid: time=  0.7s loss=3.542, TAw acc= 62.0% | lr=5.0e-02
| Epoch  94, time=  2.3s | Train: skip eval | Valid: time=  0.5s loss=3.533, TAw acc= 59.0% |
| Epoch  95, time=  2.2s | Train: skip eval | Valid: time=  0.6s loss=3.524, TAw acc= 61.8% |
| Epoch  96, time=  2.3s | Train: skip eval | Valid: time=  0.6s loss=3.527, TAw acc= 61.2% |
| Epoch  97, time=  2.2s | Train: skip eval | Valid: time=  0.6s loss=3.527, TAw acc= 60.8% |
| Epoch  98, time=  2.4s | Train: skip eval | Valid: time=  0.6s loss=3.544, TAw acc= 59.6% | lr=5.0e-02
| Epoch  99, time=  2.2s | Train: skip eval | Valid: time=  0.5s loss=3.534, TAw acc= 58.2% |
| Epoch 100, time=  2.5s | Train: skip eval | Valid: time=  0.5s loss=3.539, TAw acc= 60.4% |
Stage 2: Training bias correction layers
| Epoch  50, time=  0.4s | Train: loss=3.339, TAg acc= 18.3% |
| Epoch 100, time=  0.4s | Train: loss=3.294, TAg acc= 21.4% |
| Epoch 150, time=  0.4s | Train: loss=3.387, TAg acc= 20.9% |
| Epoch 200, time=  0.4s | Train: loss=3.335, TAg acc= 21.1% |
Stage 2: BiC training for Task 0: alpha=1.00000, beta=0.00000
Stage 2: BiC training for Task 1: alpha=0.71168, beta=-0.79590
Stage 2: BiC training for Task 2: alpha=0.53594, beta=-0.67303
Stage 2: BiC training for Task 3: alpha=0.47521, beta=-0.56372
Stage 2: BiC training for Task 4: alpha=0.59652, beta=-0.69435
Stage 2: BiC training for Task 5: alpha=0.55322, beta=-0.57669
Stage 2: BiC training for Task 6: alpha=0.55430, beta=-0.33855
| Selected 3150 train exemplars, time=  0.1s
------------------------------------------------------------------------------------------------------------
>>> Test on task  0 : loss=3.574 | TAw acc= 53.6%, forg=  4.8%| TAg acc= 26.4%, forg= 30.6% <<<
>>> Test on task  1 : loss=2.947 | TAw acc= 54.2%, forg=  5.5%| TAg acc= 26.7%, forg= 22.2% <<<
>>> Test on task  2 : loss=3.099 | TAw acc= 49.7%, forg=  3.9%| TAg acc= 21.8%, forg=  7.5% <<<
>>> Test on task  3 : loss=3.164 | TAw acc= 52.0%, forg=  4.5%| TAg acc= 18.3%, forg=  7.2% <<<
>>> Test on task  4 : loss=3.135 | TAw acc= 58.5%, forg=  0.9%| TAg acc= 27.6%, forg=  6.6% <<<
>>> Test on task  5 : loss=3.337 | TAw acc= 57.3%, forg=  0.6%| TAg acc= 28.9%, forg=  2.2% <<<
>>> Test on task  6 : loss=3.636 | TAw acc= 62.6%, forg=  0.0%| TAg acc= 31.0%, forg=  0.0% <<<
Save at ../miniimagenet_bic_result10t/miniimagenet_bic
************************************************************************************************************
Task  7
************************************************************************************************************
Stage 0: Select exemplars from validation
 > Selected 400 validation exemplars, time=  0.0s
Stage 1: Training model with distillation
| Epoch   1, time=  2.5s | Train: skip eval | Valid: time=  0.5s loss=3.715, TAw acc= 55.8% | *
| Epoch   2, time=  2.5s | Train: skip eval | Valid: time=  0.5s loss=3.710, TAw acc= 58.0% | *
| Epoch   3, time=  2.4s | Train: skip eval | Valid: time=  0.5s loss=3.702, TAw acc= 61.8% | *
| Epoch   4, time=  2.4s | Train: skip eval | Valid: time=  0.6s loss=3.714, TAw acc= 57.8% |
| Epoch   5, time=  2.5s | Train: skip eval | Valid: time=  0.5s loss=3.708, TAw acc= 60.8% |
| Epoch   6, time=  2.6s | Train: skip eval | Valid: time=  0.6s loss=3.701, TAw acc= 61.2% | *
| Epoch   7, time=  2.9s | Train: skip eval | Valid: time=  0.6s loss=3.709, TAw acc= 62.0% |
| Epoch   8, time=  2.6s | Train: skip eval | Valid: time=  0.6s loss=3.716, TAw acc= 61.2% |
| Epoch   9, time=  2.5s | Train: skip eval | Valid: time=  0.5s loss=3.710, TAw acc= 60.2% |
| Epoch  10, time=  2.6s | Train: skip eval | Valid: time=  0.6s loss=3.722, TAw acc= 59.0% |
| Epoch  11, time=  2.4s | Train: skip eval | Valid: time=  0.5s loss=3.714, TAw acc= 60.4% | lr=5.0e-02
| Epoch  12, time=  2.6s | Train: skip eval | Valid: time=  0.5s loss=3.711, TAw acc= 61.0% |
| Epoch  13, time=  2.4s | Train: skip eval | Valid: time=  0.5s loss=3.716, TAw acc= 59.2% |
| Epoch  14, time=  3.2s | Train: skip eval | Valid: time=  0.5s loss=3.717, TAw acc= 56.2% |
| Epoch  15, time=  2.4s | Train: skip eval | Valid: time=  0.6s loss=3.717, TAw acc= 58.6% |
| Epoch  16, time=  2.5s | Train: skip eval | Valid: time=  0.6s loss=3.710, TAw acc= 60.0% | lr=5.0e-02
| Epoch  17, time=  2.6s | Train: skip eval | Valid: time=  0.7s loss=3.709, TAw acc= 59.4% |
| Epoch  18, time=  2.3s | Train: skip eval | Valid: time=  0.4s loss=3.698, TAw acc= 62.4% | *
| Epoch  19, time=  2.4s | Train: skip eval | Valid: time=  0.6s loss=3.711, TAw acc= 60.8% |
| Epoch  20, time=  2.4s | Train: skip eval | Valid: time=  0.5s loss=3.699, TAw acc= 63.4% |
| Epoch  21, time=  2.3s | Train: skip eval | Valid: time=  0.9s loss=3.702, TAw acc= 64.2% |
| Epoch  22, time=  2.5s | Train: skip eval | Valid: time=  0.5s loss=3.710, TAw acc= 59.6% |
| Epoch  23, time=  2.5s | Train: skip eval | Valid: time=  0.5s loss=3.707, TAw acc= 62.6% | lr=5.0e-02
| Epoch  24, time=  2.4s | Train: skip eval | Valid: time=  0.9s loss=3.712, TAw acc= 59.4% |
| Epoch  25, time=  3.4s | Train: skip eval | Valid: time=  0.6s loss=3.718, TAw acc= 57.8% |
| Epoch  26, time=  2.4s | Train: skip eval | Valid: time=  0.4s loss=3.725, TAw acc= 57.2% |
| Epoch  27, time=  2.4s | Train: skip eval | Valid: time=  0.6s loss=3.715, TAw acc= 60.4% |
| Epoch  28, time=  2.6s | Train: skip eval | Valid: time=  0.8s loss=3.714, TAw acc= 59.8% | lr=5.0e-02
| Epoch  29, time=  2.4s | Train: skip eval | Valid: time=  0.6s loss=3.697, TAw acc= 65.0% | *
| Epoch  30, time=  2.4s | Train: skip eval | Valid: time=  0.7s loss=3.702, TAw acc= 60.2% |
| Epoch  31, time=  2.5s | Train: skip eval | Valid: time=  0.5s loss=3.711, TAw acc= 62.2% |
| Epoch  32, time=  3.3s | Train: skip eval | Valid: time=  0.5s loss=3.707, TAw acc= 62.0% |
| Epoch  33, time=  2.6s | Train: skip eval | Valid: time=  0.6s loss=3.706, TAw acc= 63.2% |
| Epoch  34, time=  2.3s | Train: skip eval | Valid: time=  0.6s loss=3.713, TAw acc= 64.2% | lr=5.0e-02
| Epoch  35, time=  3.0s | Train: skip eval | Valid: time=  0.5s loss=3.697, TAw acc= 60.6% | *
| Epoch  36, time=  2.3s | Train: skip eval | Valid: time=  0.7s loss=3.705, TAw acc= 61.2% |
| Epoch  37, time=  2.4s | Train: skip eval | Valid: time=  0.4s loss=3.713, TAw acc= 61.6% |
| Epoch  38, time=  2.4s | Train: skip eval | Valid: time=  0.5s loss=3.716, TAw acc= 58.8% |
| Epoch  39, time=  2.3s | Train: skip eval | Valid: time=  0.5s loss=3.713, TAw acc= 60.8% |
| Epoch  40, time=  2.4s | Train: skip eval | Valid: time=  0.5s loss=3.731, TAw acc= 57.0% | lr=5.0e-02
| Epoch  41, time=  2.4s | Train: skip eval | Valid: time=  0.5s loss=3.714, TAw acc= 61.2% |
| Epoch  42, time=  2.2s | Train: skip eval | Valid: time=  0.6s loss=3.701, TAw acc= 63.2% |
| Epoch  43, time=  2.4s | Train: skip eval | Valid: time=  0.8s loss=3.705, TAw acc= 60.4% |
| Epoch  44, time=  2.5s | Train: skip eval | Valid: time=  0.5s loss=3.707, TAw acc= 63.4% |
| Epoch  45, time=  2.4s | Train: skip eval | Valid: time=  0.6s loss=3.718, TAw acc= 61.8% | lr=5.0e-02
| Epoch  46, time=  2.3s | Train: skip eval | Valid: time=  0.5s loss=3.696, TAw acc= 62.8% | *
| Epoch  47, time=  3.1s | Train: skip eval | Valid: time=  0.5s loss=3.719, TAw acc= 60.2% |
| Epoch  48, time=  2.8s | Train: skip eval | Valid: time=  0.6s loss=3.710, TAw acc= 59.8% |
| Epoch  49, time=  2.4s | Train: skip eval | Valid: time=  0.5s loss=3.717, TAw acc= 61.0% |
| Epoch  50, time=  2.5s | Train: skip eval | Valid: time=  0.6s loss=3.710, TAw acc= 62.4% |
| Epoch  51, time=  2.4s | Train: skip eval | Valid: time=  0.5s loss=3.718, TAw acc= 59.2% | lr=5.0e-02
| Epoch  52, time=  2.5s | Train: skip eval | Valid: time=  0.5s loss=3.704, TAw acc= 63.8% |
| Epoch  53, time=  2.3s | Train: skip eval | Valid: time=  0.5s loss=3.711, TAw acc= 58.2% |
| Epoch  54, time=  2.5s | Train: skip eval | Valid: time=  0.5s loss=3.707, TAw acc= 60.0% |
| Epoch  55, time=  2.4s | Train: skip eval | Valid: time=  0.7s loss=3.717, TAw acc= 63.2% |
| Epoch  56, time=  2.4s | Train: skip eval | Valid: time=  0.6s loss=3.722, TAw acc= 59.8% | lr=5.0e-02
| Epoch  57, time=  2.5s | Train: skip eval | Valid: time=  0.6s loss=3.719, TAw acc= 61.2% |
| Epoch  58, time=  3.1s | Train: skip eval | Valid: time=  0.6s loss=3.715, TAw acc= 61.6% |
| Epoch  59, time=  2.4s | Train: skip eval | Valid: time=  0.5s loss=3.709, TAw acc= 61.6% |
| Epoch  60, time=  2.4s | Train: skip eval | Valid: time=  0.5s loss=3.712, TAw acc= 60.4% |
| Epoch  61, time=  2.5s | Train: skip eval | Valid: time=  0.7s loss=3.718, TAw acc= 59.4% | lr=5.0e-02
| Epoch  62, time=  2.5s | Train: skip eval | Valid: time=  0.6s loss=3.712, TAw acc= 59.8% |
| Epoch  63, time=  2.4s | Train: skip eval | Valid: time=  0.4s loss=3.711, TAw acc= 61.6% |
| Epoch  64, time=  2.6s | Train: skip eval | Valid: time=  0.6s loss=3.704, TAw acc= 63.6% |
| Epoch  65, time=  2.6s | Train: skip eval | Valid: time=  0.5s loss=3.730, TAw acc= 59.0% |
| Epoch  66, time=  2.3s | Train: skip eval | Valid: time=  0.6s loss=3.708, TAw acc= 61.8% | lr=5.0e-02
| Epoch  67, time=  2.4s | Train: skip eval | Valid: time=  0.5s loss=3.717, TAw acc= 60.6% |
| Epoch  68, time=  2.5s | Train: skip eval | Valid: time=  0.5s loss=3.716, TAw acc= 59.2% |
| Epoch  69, time=  3.3s | Train: skip eval | Valid: time=  0.5s loss=3.714, TAw acc= 61.0% |
| Epoch  70, time=  2.5s | Train: skip eval | Valid: time=  0.5s loss=3.714, TAw acc= 60.6% |
| Epoch  71, time=  2.4s | Train: skip eval | Valid: time=  0.8s loss=3.717, TAw acc= 60.4% | lr=5.0e-02
| Epoch  72, time=  2.5s | Train: skip eval | Valid: time=  0.6s loss=3.707, TAw acc= 61.6% |
| Epoch  73, time=  2.3s | Train: skip eval | Valid: time=  0.5s loss=3.713, TAw acc= 62.4% |
| Epoch  74, time=  2.5s | Train: skip eval | Valid: time=  0.6s loss=3.717, TAw acc= 60.0% |
| Epoch  75, time=  2.3s | Train: skip eval | Valid: time=  0.6s loss=3.720, TAw acc= 58.4% |
| Epoch  76, time=  2.6s | Train: skip eval | Valid: time=  0.5s loss=3.723, TAw acc= 61.2% | lr=5.0e-02
| Epoch  77, time=  2.4s | Train: skip eval | Valid: time=  0.5s loss=3.711, TAw acc= 59.8% |
| Epoch  78, time=  2.4s | Train: skip eval | Valid: time=  0.5s loss=3.713, TAw acc= 61.8% |
| Epoch  79, time=  2.4s | Train: skip eval | Valid: time=  0.5s loss=3.711, TAw acc= 59.8% |
| Epoch  80, time=  3.2s | Train: skip eval | Valid: time=  0.6s loss=3.704, TAw acc= 61.4% |
| Epoch  81, time=  2.4s | Train: skip eval | Valid: time=  0.6s loss=3.720, TAw acc= 61.0% | lr=5.0e-02
| Epoch  82, time=  2.3s | Train: skip eval | Valid: time=  0.6s loss=3.710, TAw acc= 60.4% |
| Epoch  83, time=  2.2s | Train: skip eval | Valid: time=  0.9s loss=3.722, TAw acc= 59.8% |
| Epoch  84, time=  2.3s | Train: skip eval | Valid: time=  0.6s loss=3.711, TAw acc= 59.6% |
| Epoch  85, time=  2.4s | Train: skip eval | Valid: time=  0.5s loss=3.713, TAw acc= 60.2% |
| Epoch  86, time=  2.5s | Train: skip eval | Valid: time=  0.5s loss=3.712, TAw acc= 63.4% | lr=5.0e-02
| Epoch  87, time=  2.4s | Train: skip eval | Valid: time=  0.5s loss=3.706, TAw acc= 61.0% |
| Epoch  88, time=  2.6s | Train: skip eval | Valid: time=  0.6s loss=3.724, TAw acc= 59.8% |
| Epoch  89, time=  2.5s | Train: skip eval | Valid: time=  0.7s loss=3.713, TAw acc= 58.8% |
| Epoch  90, time=  2.4s | Train: skip eval | Valid: time=  0.5s loss=3.719, TAw acc= 60.0% |
| Epoch  91, time=  3.1s | Train: skip eval | Valid: time=  0.4s loss=3.728, TAw acc= 60.8% | lr=5.0e-02
| Epoch  92, time=  2.4s | Train: skip eval | Valid: time=  0.4s loss=3.709, TAw acc= 57.6% |
| Epoch  93, time=  2.4s | Train: skip eval | Valid: time=  0.5s loss=3.730, TAw acc= 57.4% |
| Epoch  94, time=  2.6s | Train: skip eval | Valid: time=  0.9s loss=3.713, TAw acc= 60.0% |
| Epoch  95, time=  2.3s | Train: skip eval | Valid: time=  0.6s loss=3.711, TAw acc= 62.4% |
| Epoch  96, time=  2.5s | Train: skip eval | Valid: time=  0.7s loss=3.723, TAw acc= 60.2% | lr=5.0e-02
| Epoch  97, time=  2.4s | Train: skip eval | Valid: time=  0.7s loss=3.720, TAw acc= 60.4% |
| Epoch  98, time=  2.5s | Train: skip eval | Valid: time=  0.5s loss=3.704, TAw acc= 61.8% |
| Epoch  99, time=  2.6s | Train: skip eval | Valid: time=  0.6s loss=3.716, TAw acc= 59.6% |
| Epoch 100, time=  2.6s | Train: skip eval | Valid: time=  0.7s loss=3.711, TAw acc= 60.8% |
Stage 2: Training bias correction layers
| Epoch  50, time=  0.4s | Train: loss=3.515, TAg acc= 16.2% |
| Epoch 100, time=  0.5s | Train: loss=3.487, TAg acc= 19.5% |
| Epoch 150, time=  0.5s | Train: loss=3.453, TAg acc= 19.5% |
| Epoch 200, time=  0.4s | Train: loss=3.434, TAg acc= 20.2% |
Stage 2: BiC training for Task 0: alpha=1.00000, beta=0.00000
Stage 2: BiC training for Task 1: alpha=0.71168, beta=-0.79590
Stage 2: BiC training for Task 2: alpha=0.53594, beta=-0.67303
Stage 2: BiC training for Task 3: alpha=0.47521, beta=-0.56372
Stage 2: BiC training for Task 4: alpha=0.59652, beta=-0.69435
Stage 2: BiC training for Task 5: alpha=0.55322, beta=-0.57669
Stage 2: BiC training for Task 6: alpha=0.55430, beta=-0.33855
Stage 2: BiC training for Task 7: alpha=0.55138, beta=-0.45528
| Selected 3600 train exemplars, time=  0.1s
------------------------------------------------------------------------------------------------------------
>>> Test on task  0 : loss=3.680 | TAw acc= 54.1%, forg=  4.3%| TAg acc= 26.5%, forg= 30.5% <<<
>>> Test on task  1 : loss=3.144 | TAw acc= 53.8%, forg=  5.9%| TAg acc= 25.4%, forg= 23.5% <<<
>>> Test on task  2 : loss=3.223 | TAw acc= 50.1%, forg=  3.5%| TAg acc= 21.7%, forg=  7.6% <<<
>>> Test on task  3 : loss=3.240 | TAw acc= 52.0%, forg=  4.5%| TAg acc= 19.9%, forg=  5.6% <<<
>>> Test on task  4 : loss=3.199 | TAw acc= 56.4%, forg=  3.0%| TAg acc= 24.0%, forg= 10.2% <<<
>>> Test on task  5 : loss=3.316 | TAw acc= 55.1%, forg=  2.8%| TAg acc= 27.2%, forg=  3.9% <<<
>>> Test on task  6 : loss=3.549 | TAw acc= 60.0%, forg=  2.6%| TAg acc= 27.3%, forg=  3.7% <<<
>>> Test on task  7 : loss=3.825 | TAw acc= 63.3%, forg=  0.0%| TAg acc= 27.2%, forg=  0.0% <<<
Save at ../miniimagenet_bic_result10t/miniimagenet_bic
************************************************************************************************************
Task  8
************************************************************************************************************
Stage 0: Select exemplars from validation
 > Selected 450 validation exemplars, time=  0.0s
Stage 1: Training model with distillation
| Epoch   1, time=  2.7s | Train: skip eval | Valid: time=  0.5s loss=3.812, TAw acc= 61.2% | *
| Epoch   2, time=  2.5s | Train: skip eval | Valid: time=  0.6s loss=3.807, TAw acc= 63.4% | *
| Epoch   3, time=  3.3s | Train: skip eval | Valid: time=  0.5s loss=3.808, TAw acc= 65.4% |
| Epoch   4, time=  2.6s | Train: skip eval | Valid: time=  0.6s loss=3.803, TAw acc= 64.0% | *
| Epoch   5, time=  2.7s | Train: skip eval | Valid: time=  0.6s loss=3.808, TAw acc= 66.0% |
| Epoch   6, time=  2.5s | Train: skip eval | Valid: time=  0.8s loss=3.812, TAw acc= 64.4% |
| Epoch   7, time=  2.6s | Train: skip eval | Valid: time=  0.6s loss=3.811, TAw acc= 67.8% |
| Epoch   8, time=  2.5s | Train: skip eval | Valid: time=  0.7s loss=3.812, TAw acc= 64.2% |
| Epoch   9, time=  2.5s | Train: skip eval | Valid: time=  0.6s loss=3.809, TAw acc= 67.6% | lr=5.0e-02
| Epoch  10, time=  2.6s | Train: skip eval | Valid: time=  0.6s loss=3.806, TAw acc= 67.8% |
| Epoch  11, time=  2.8s | Train: skip eval | Valid: time=  0.6s loss=3.805, TAw acc= 66.6% |
| Epoch  12, time=  2.5s | Train: skip eval | Valid: time=  0.7s loss=3.805, TAw acc= 66.4% |
| Epoch  13, time=  2.6s | Train: skip eval | Valid: time=  0.6s loss=3.806, TAw acc= 65.2% |
| Epoch  14, time=  2.6s | Train: skip eval | Valid: time=  0.5s loss=3.813, TAw acc= 67.2% | lr=5.0e-02
| Epoch  15, time=  2.7s | Train: skip eval | Valid: time=  0.5s loss=3.812, TAw acc= 65.6% |
| Epoch  16, time=  2.6s | Train: skip eval | Valid: time=  0.6s loss=3.799, TAw acc= 67.0% | *
| Epoch  17, time=  3.4s | Train: skip eval | Valid: time=  0.5s loss=3.808, TAw acc= 66.4% |
| Epoch  18, time=  2.7s | Train: skip eval | Valid: time=  0.5s loss=3.809, TAw acc= 63.6% |
| Epoch  19, time=  2.6s | Train: skip eval | Valid: time=  0.5s loss=3.814, TAw acc= 65.0% |
| Epoch  20, time=  2.7s | Train: skip eval | Valid: time=  0.8s loss=3.800, TAw acc= 67.4% |
| Epoch  21, time=  2.6s | Train: skip eval | Valid: time=  0.4s loss=3.809, TAw acc= 70.8% | lr=5.0e-02
| Epoch  22, time=  2.8s | Train: skip eval | Valid: time=  0.6s loss=3.809, TAw acc= 65.0% |
| Epoch  23, time=  2.6s | Train: skip eval | Valid: time=  0.5s loss=3.806, TAw acc= 66.6% |
| Epoch  24, time=  3.1s | Train: skip eval | Valid: time=  0.6s loss=3.805, TAw acc= 68.0% |
| Epoch  25, time=  2.7s | Train: skip eval | Valid: time=  0.6s loss=3.814, TAw acc= 63.8% |
| Epoch  26, time=  2.5s | Train: skip eval | Valid: time=  0.7s loss=3.801, TAw acc= 66.6% | lr=5.0e-02
| Epoch  27, time=  2.8s | Train: skip eval | Valid: time=  0.5s loss=3.807, TAw acc= 67.0% |
| Epoch  28, time=  2.6s | Train: skip eval | Valid: time=  0.8s loss=3.815, TAw acc= 63.4% |
| Epoch  29, time=  2.6s | Train: skip eval | Valid: time=  0.5s loss=3.810, TAw acc= 67.6% |
| Epoch  30, time=  2.5s | Train: skip eval | Valid: time=  1.5s loss=3.821, TAw acc= 66.4% |
| Epoch  31, time=  2.6s | Train: skip eval | Valid: time=  0.6s loss=3.806, TAw acc= 67.4% | lr=5.0e-02
| Epoch  32, time=  2.6s | Train: skip eval | Valid: time=  0.6s loss=3.809, TAw acc= 68.0% |
| Epoch  33, time=  2.7s | Train: skip eval | Valid: time=  0.5s loss=3.803, TAw acc= 68.0% |
| Epoch  34, time=  3.4s | Train: skip eval | Valid: time=  0.5s loss=3.810, TAw acc= 65.8% |
| Epoch  35, time=  2.5s | Train: skip eval | Valid: time=  0.5s loss=3.804, TAw acc= 67.0% |
| Epoch  36, time=  2.5s | Train: skip eval | Valid: time=  0.6s loss=3.811, TAw acc= 65.8% | lr=5.0e-02
| Epoch  37, time=  2.8s | Train: skip eval | Valid: time=  0.5s loss=3.804, TAw acc= 67.2% |
| Epoch  38, time=  2.6s | Train: skip eval | Valid: time=  0.5s loss=3.813, TAw acc= 66.8% |
| Epoch  39, time=  2.5s | Train: skip eval | Valid: time=  0.7s loss=3.801, TAw acc= 68.0% |
| Epoch  40, time=  2.6s | Train: skip eval | Valid: time=  1.4s loss=3.800, TAw acc= 67.8% |
| Epoch  41, time=  2.6s | Train: skip eval | Valid: time=  0.5s loss=3.806, TAw acc= 67.8% | lr=5.0e-02
| Epoch  42, time=  2.7s | Train: skip eval | Valid: time=  0.7s loss=3.802, TAw acc= 65.4% |
| Epoch  43, time=  2.8s | Train: skip eval | Valid: time=  0.6s loss=3.808, TAw acc= 66.8% |
| Epoch  44, time=  3.2s | Train: skip eval | Valid: time=  0.6s loss=3.818, TAw acc= 65.6% |
| Epoch  45, time=  2.7s | Train: skip eval | Valid: time=  0.6s loss=3.811, TAw acc= 66.4% |
| Epoch  46, time=  2.6s | Train: skip eval | Valid: time=  0.5s loss=3.812, TAw acc= 65.8% | lr=5.0e-02
| Epoch  47, time=  2.6s | Train: skip eval | Valid: time=  0.6s loss=3.811, TAw acc= 64.4% |
| Epoch  48, time=  2.8s | Train: skip eval | Valid: time=  0.4s loss=3.804, TAw acc= 67.0% |
| Epoch  49, time=  2.7s | Train: skip eval | Valid: time=  0.5s loss=3.815, TAw acc= 64.6% |
| Epoch  50, time=  2.7s | Train: skip eval | Valid: time=  0.6s loss=3.813, TAw acc= 65.0% |
| Epoch  51, time=  3.7s | Train: skip eval | Valid: time=  0.7s loss=3.818, TAw acc= 64.8% | lr=5.0e-02
| Epoch  52, time=  2.5s | Train: skip eval | Valid: time=  0.6s loss=3.807, TAw acc= 63.4% |
| Epoch  53, time=  2.7s | Train: skip eval | Valid: time=  0.6s loss=3.808, TAw acc= 66.4% |
| Epoch  54, time=  3.7s | Train: skip eval | Valid: time=  0.5s loss=3.811, TAw acc= 65.4% |
| Epoch  55, time=  2.6s | Train: skip eval | Valid: time=  0.5s loss=3.810, TAw acc= 68.2% |
| Epoch  56, time=  2.8s | Train: skip eval | Valid: time=  0.4s loss=3.809, TAw acc= 67.2% | lr=5.0e-02
| Epoch  57, time=  2.7s | Train: skip eval | Valid: time=  0.5s loss=3.803, TAw acc= 67.4% |
| Epoch  58, time=  2.6s | Train: skip eval | Valid: time=  0.6s loss=3.812, TAw acc= 65.4% |
| Epoch  59, time=  2.6s | Train: skip eval | Valid: time=  0.5s loss=3.810, TAw acc= 66.2% |
| Epoch  60, time=  2.6s | Train: skip eval | Valid: time=  1.7s loss=3.807, TAw acc= 68.6% |
| Epoch  61, time=  2.6s | Train: skip eval | Valid: time=  0.5s loss=3.815, TAw acc= 65.2% | lr=5.0e-02
| Epoch  62, time=  2.6s | Train: skip eval | Valid: time=  0.7s loss=3.806, TAw acc= 64.4% |
| Epoch  63, time=  2.5s | Train: skip eval | Valid: time=  0.6s loss=3.801, TAw acc= 64.8% |
| Epoch  64, time=  2.5s | Train: skip eval | Valid: time=  0.5s loss=3.804, TAw acc= 65.4% |
| Epoch  65, time=  2.4s | Train: skip eval | Valid: time=  0.5s loss=3.804, TAw acc= 66.2% |
| Epoch  66, time=  2.5s | Train: skip eval | Valid: time=  0.5s loss=3.807, TAw acc= 67.0% | lr=5.0e-02
| Epoch  67, time=  2.6s | Train: skip eval | Valid: time=  0.4s loss=3.801, TAw acc= 67.8% |
| Epoch  68, time=  3.1s | Train: skip eval | Valid: time=  0.4s loss=3.804, TAw acc= 67.0% |
| Epoch  69, time=  2.7s | Train: skip eval | Valid: time=  0.5s loss=3.799, TAw acc= 67.0% |
| Epoch  70, time=  2.6s | Train: skip eval | Valid: time=  0.6s loss=3.810, TAw acc= 67.4% |
| Epoch  71, time=  2.5s | Train: skip eval | Valid: time=  0.6s loss=3.812, TAw acc= 66.6% | lr=5.0e-02
| Epoch  72, time=  2.6s | Train: skip eval | Valid: time=  0.5s loss=3.820, TAw acc= 64.8% |
| Epoch  73, time=  2.8s | Train: skip eval | Valid: time=  0.5s loss=3.805, TAw acc= 66.6% |
| Epoch  74, time=  2.8s | Train: skip eval | Valid: time=  1.7s loss=3.816, TAw acc= 65.6% |
| Epoch  75, time=  2.7s | Train: skip eval | Valid: time=  0.6s loss=3.799, TAw acc= 66.6% |
| Epoch  76, time=  2.5s | Train: skip eval | Valid: time=  0.5s loss=3.818, TAw acc= 67.4% | lr=5.0e-02
| Epoch  77, time=  2.5s | Train: skip eval | Valid: time=  0.8s loss=3.815, TAw acc= 64.8% |
| Epoch  78, time=  4.0s | Train: skip eval | Valid: time=  0.6s loss=3.798, TAw acc= 67.2% | *
| Epoch  79, time=  2.5s | Train: skip eval | Valid: time=  0.6s loss=3.805, TAw acc= 67.4% |
| Epoch  80, time=  2.6s | Train: skip eval | Valid: time=  0.6s loss=3.806, TAw acc= 65.4% |
| Epoch  81, time=  2.4s | Train: skip eval | Valid: time=  0.5s loss=3.810, TAw acc= 65.4% |
| Epoch  82, time=  2.7s | Train: skip eval | Valid: time=  0.5s loss=3.798, TAw acc= 67.4% | *
| Epoch  83, time=  2.6s | Train: skip eval | Valid: time=  0.5s loss=3.810, TAw acc= 69.2% |
| Epoch  84, time=  2.6s | Train: skip eval | Valid: time=  1.8s loss=3.811, TAw acc= 66.0% |
| Epoch  85, time=  2.6s | Train: skip eval | Valid: time=  0.5s loss=3.815, TAw acc= 65.8% |
| Epoch  86, time=  2.5s | Train: skip eval | Valid: time=  0.5s loss=3.816, TAw acc= 69.0% |
| Epoch  87, time=  2.6s | Train: skip eval | Valid: time=  0.7s loss=3.810, TAw acc= 69.4% | lr=5.0e-02
| Epoch  88, time=  3.3s | Train: skip eval | Valid: time=  0.5s loss=3.808, TAw acc= 66.2% |
| Epoch  89, time=  2.7s | Train: skip eval | Valid: time=  0.5s loss=3.815, TAw acc= 65.2% |
| Epoch  90, time=  2.7s | Train: skip eval | Valid: time=  0.6s loss=3.806, TAw acc= 68.8% |
| Epoch  91, time=  2.6s | Train: skip eval | Valid: time=  0.5s loss=3.816, TAw acc= 65.6% |
| Epoch  92, time=  2.5s | Train: skip eval | Valid: time=  0.5s loss=3.817, TAw acc= 65.2% | lr=5.0e-02
| Epoch  93, time=  2.5s | Train: skip eval | Valid: time=  0.6s loss=3.807, TAw acc= 66.8% |
| Epoch  94, time=  2.9s | Train: skip eval | Valid: time=  0.5s loss=3.812, TAw acc= 65.6% |
| Epoch  95, time=  4.0s | Train: skip eval | Valid: time=  0.6s loss=3.822, TAw acc= 65.0% |
| Epoch  96, time=  2.6s | Train: skip eval | Valid: time=  0.5s loss=3.802, TAw acc= 67.0% |
| Epoch  97, time=  2.4s | Train: skip eval | Valid: time=  0.5s loss=3.813, TAw acc= 66.4% | lr=5.0e-02
| Epoch  98, time=  2.6s | Train: skip eval | Valid: time=  0.6s loss=3.809, TAw acc= 64.4% |
| Epoch  99, time=  2.8s | Train: skip eval | Valid: time=  0.5s loss=3.811, TAw acc= 66.6% |
| Epoch 100, time=  2.7s | Train: skip eval | Valid: time=  0.5s loss=3.809, TAw acc= 66.8% |
Stage 2: Training bias correction layers
| Epoch  50, time=  0.4s | Train: loss=3.416, TAg acc= 21.1% |
| Epoch 100, time=  0.5s | Train: loss=3.417, TAg acc= 20.4% |
| Epoch 150, time=  0.7s | Train: loss=3.476, TAg acc= 19.1% |
| Epoch 200, time=  0.6s | Train: loss=3.428, TAg acc= 19.6% |
Stage 2: BiC training for Task 0: alpha=1.00000, beta=0.00000
Stage 2: BiC training for Task 1: alpha=0.71168, beta=-0.79590
Stage 2: BiC training for Task 2: alpha=0.53594, beta=-0.67303
Stage 2: BiC training for Task 3: alpha=0.47521, beta=-0.56372
Stage 2: BiC training for Task 4: alpha=0.59652, beta=-0.69435
Stage 2: BiC training for Task 5: alpha=0.55322, beta=-0.57669
Stage 2: BiC training for Task 6: alpha=0.55430, beta=-0.33855
Stage 2: BiC training for Task 7: alpha=0.55138, beta=-0.45528
Stage 2: BiC training for Task 8: alpha=0.61315, beta=-0.50480
| Selected 4050 train exemplars, time=  0.1s
------------------------------------------------------------------------------------------------------------
>>> Test on task  0 : loss=3.774 | TAw acc= 54.8%, forg=  3.6%| TAg acc= 26.1%, forg= 30.9% <<<
>>> Test on task  1 : loss=3.433 | TAw acc= 51.8%, forg=  7.9%| TAg acc= 21.4%, forg= 27.5% <<<
>>> Test on task  2 : loss=3.347 | TAw acc= 50.1%, forg=  3.5%| TAg acc= 21.4%, forg=  7.9% <<<
>>> Test on task  3 : loss=3.372 | TAw acc= 50.7%, forg=  5.8%| TAg acc= 16.5%, forg=  9.0% <<<
>>> Test on task  4 : loss=3.216 | TAw acc= 54.3%, forg=  5.1%| TAg acc= 26.1%, forg=  8.1% <<<
>>> Test on task  5 : loss=3.345 | TAw acc= 54.8%, forg=  3.1%| TAg acc= 25.2%, forg=  5.9% <<<
>>> Test on task  6 : loss=3.486 | TAw acc= 59.1%, forg=  3.5%| TAg acc= 24.3%, forg=  6.7% <<<
>>> Test on task  7 : loss=3.743 | TAw acc= 61.6%, forg=  1.7%| TAg acc= 22.0%, forg=  5.2% <<<
>>> Test on task  8 : loss=3.909 | TAw acc= 65.8%, forg=  0.0%| TAg acc= 36.3%, forg=  0.0% <<<
Save at ../miniimagenet_bic_result10t/miniimagenet_bic
************************************************************************************************************
Task  9
************************************************************************************************************
Stage 0: Select exemplars from validation
 > Selected 500 validation exemplars, time=  0.0s
Stage 1: Training model with distillation
| Epoch   1, time=  3.0s | Train: skip eval | Valid: time=  0.7s loss=3.977, TAw acc= 58.8% | *
| Epoch   2, time=  2.6s | Train: skip eval | Valid: time=  0.8s loss=3.972, TAw acc= 60.2% | *
| Epoch   3, time=  2.8s | Train: skip eval | Valid: time=  0.6s loss=3.965, TAw acc= 65.4% | *
| Epoch   4, time=  2.8s | Train: skip eval | Valid: time=  0.5s loss=3.968, TAw acc= 62.8% |
| Epoch   5, time=  2.7s | Train: skip eval | Valid: time=  0.5s loss=3.968, TAw acc= 62.0% |
| Epoch   6, time=  3.5s | Train: skip eval | Valid: time=  0.5s loss=3.969, TAw acc= 64.2% |
| Epoch   7, time=  2.8s | Train: skip eval | Valid: time=  0.6s loss=3.976, TAw acc= 63.2% |
| Epoch   8, time=  2.7s | Train: skip eval | Valid: time=  0.6s loss=3.974, TAw acc= 63.0% | lr=5.0e-02
| Epoch   9, time=  3.3s | Train: skip eval | Valid: time=  0.5s loss=3.970, TAw acc= 61.8% |
| Epoch  10, time=  3.0s | Train: skip eval | Valid: time=  0.7s loss=3.969, TAw acc= 62.0% |
| Epoch  11, time=  2.9s | Train: skip eval | Valid: time=  0.5s loss=3.975, TAw acc= 62.8% |
| Epoch  12, time=  2.8s | Train: skip eval | Valid: time=  0.5s loss=3.975, TAw acc= 60.0% |
| Epoch  13, time=  2.6s | Train: skip eval | Valid: time=  0.5s loss=3.968, TAw acc= 62.8% | lr=5.0e-02
| Epoch  14, time=  2.8s | Train: skip eval | Valid: time=  0.6s loss=3.968, TAw acc= 62.6% |
| Epoch  15, time=  2.6s | Train: skip eval | Valid: time=  1.1s loss=3.969, TAw acc= 64.0% |
| Epoch  16, time=  2.7s | Train: skip eval | Valid: time=  0.6s loss=3.969, TAw acc= 62.4% |
| Epoch  17, time=  2.8s | Train: skip eval | Valid: time=  0.5s loss=3.972, TAw acc= 63.8% |
| Epoch  18, time=  3.0s | Train: skip eval | Valid: time=  1.7s loss=3.978, TAw acc= 62.4% | lr=5.0e-02
| Epoch  19, time=  2.6s | Train: skip eval | Valid: time=  0.5s loss=3.968, TAw acc= 63.2% |
| Epoch  20, time=  2.6s | Train: skip eval | Valid: time=  0.5s loss=3.977, TAw acc= 59.4% |
| Epoch  21, time=  2.7s | Train: skip eval | Valid: time=  0.6s loss=3.973, TAw acc= 63.6% |
| Epoch  22, time=  3.7s | Train: skip eval | Valid: time=  0.5s loss=3.967, TAw acc= 64.6% |
| Epoch  23, time=  2.7s | Train: skip eval | Valid: time=  0.6s loss=3.964, TAw acc= 67.0% | *
| Epoch  24, time=  2.9s | Train: skip eval | Valid: time=  0.6s loss=3.965, TAw acc= 66.6% |
| Epoch  25, time=  2.6s | Train: skip eval | Valid: time=  0.4s loss=3.973, TAw acc= 62.4% |
| Epoch  26, time=  2.7s | Train: skip eval | Valid: time=  0.5s loss=3.971, TAw acc= 64.4% |
| Epoch  27, time=  2.6s | Train: skip eval | Valid: time=  0.7s loss=3.971, TAw acc= 65.0% |
| Epoch  28, time=  2.8s | Train: skip eval | Valid: time=  0.9s loss=3.977, TAw acc= 65.0% | lr=5.0e-02
| Epoch  29, time=  2.7s | Train: skip eval | Valid: time=  0.6s loss=3.971, TAw acc= 65.0% |
| Epoch  30, time=  2.7s | Train: skip eval | Valid: time=  0.6s loss=3.979, TAw acc= 64.2% |
| Epoch  31, time=  2.6s | Train: skip eval | Valid: time=  0.5s loss=3.974, TAw acc= 64.6% |
| Epoch  32, time=  3.6s | Train: skip eval | Valid: time=  0.5s loss=3.970, TAw acc= 61.8% |
| Epoch  33, time=  2.7s | Train: skip eval | Valid: time=  0.6s loss=3.984, TAw acc= 62.0% | lr=5.0e-02
| Epoch  34, time=  2.8s | Train: skip eval | Valid: time=  0.5s loss=3.976, TAw acc= 61.0% |
| Epoch  35, time=  2.8s | Train: skip eval | Valid: time=  0.6s loss=3.965, TAw acc= 61.8% |
| Epoch  36, time=  2.7s | Train: skip eval | Valid: time=  0.6s loss=3.963, TAw acc= 64.8% | *
| Epoch  37, time=  2.6s | Train: skip eval | Valid: time=  0.6s loss=3.973, TAw acc= 64.4% |
| Epoch  38, time=  2.7s | Train: skip eval | Valid: time=  1.0s loss=3.977, TAw acc= 65.0% |
| Epoch  39, time=  2.8s | Train: skip eval | Valid: time=  0.7s loss=3.966, TAw acc= 63.6% |
| Epoch  40, time=  2.9s | Train: skip eval | Valid: time=  0.6s loss=3.976, TAw acc= 64.6% |
| Epoch  41, time=  2.8s | Train: skip eval | Valid: time=  0.6s loss=3.976, TAw acc= 64.2% | lr=5.0e-02
| Epoch  42, time=  3.5s | Train: skip eval | Valid: time=  0.5s loss=3.974, TAw acc= 64.2% |
| Epoch  43, time=  2.8s | Train: skip eval | Valid: time=  0.6s loss=3.963, TAw acc= 63.4% |
| Epoch  44, time=  2.8s | Train: skip eval | Valid: time=  0.5s loss=3.978, TAw acc= 64.2% |
| Epoch  45, time=  3.8s | Train: skip eval | Valid: time=  0.5s loss=3.975, TAw acc= 64.8% |
| Epoch  46, time=  2.6s | Train: skip eval | Valid: time=  0.6s loss=3.988, TAw acc= 62.2% | lr=5.0e-02
| Epoch  47, time=  2.6s | Train: skip eval | Valid: time=  0.7s loss=3.969, TAw acc= 62.0% |
| Epoch  48, time=  2.7s | Train: skip eval | Valid: time=  0.6s loss=3.974, TAw acc= 63.4% |
| Epoch  49, time=  2.8s | Train: skip eval | Valid: time=  0.5s loss=3.985, TAw acc= 65.0% |
| Epoch  50, time=  2.8s | Train: skip eval | Valid: time=  0.6s loss=3.979, TAw acc= 64.6% |
| Epoch  51, time=  2.7s | Train: skip eval | Valid: time=  1.0s loss=3.987, TAw acc= 61.4% | lr=5.0e-02
| Epoch  52, time=  2.9s | Train: skip eval | Valid: time=  0.6s loss=3.976, TAw acc= 63.6% |
| Epoch  53, time=  2.9s | Train: skip eval | Valid: time=  0.6s loss=3.988, TAw acc= 63.8% |
| Epoch  54, time=  2.6s | Train: skip eval | Valid: time=  0.7s loss=3.988, TAw acc= 64.2% |
| Epoch  55, time=  3.6s | Train: skip eval | Valid: time=  0.6s loss=3.977, TAw acc= 63.0% |
| Epoch  56, time=  2.8s | Train: skip eval | Valid: time=  0.5s loss=3.993, TAw acc= 60.8% | lr=5.0e-02
| Epoch  57, time=  2.9s | Train: skip eval | Valid: time=  0.6s loss=3.975, TAw acc= 65.8% |
| Epoch  58, time=  3.5s | Train: skip eval | Valid: time=  0.5s loss=3.980, TAw acc= 63.6% |
| Epoch  59, time=  2.6s | Train: skip eval | Valid: time=  0.5s loss=3.981, TAw acc= 62.8% |
| Epoch  60, time=  2.8s | Train: skip eval | Valid: time=  0.5s loss=3.976, TAw acc= 65.2% |
| Epoch  61, time=  2.7s | Train: skip eval | Valid: time=  0.6s loss=3.975, TAw acc= 63.0% | lr=5.0e-02
| Epoch  62, time=  2.8s | Train: skip eval | Valid: time=  0.6s loss=3.966, TAw acc= 64.4% |
| Epoch  63, time=  2.9s | Train: skip eval | Valid: time=  0.6s loss=3.972, TAw acc= 62.8% |
| Epoch  64, time=  2.8s | Train: skip eval | Valid: time=  0.4s loss=3.983, TAw acc= 66.0% |
| Epoch  65, time=  2.7s | Train: skip eval | Valid: time=  0.6s loss=3.978, TAw acc= 62.4% |
| Epoch  66, time=  2.6s | Train: skip eval | Valid: time=  0.6s loss=3.980, TAw acc= 65.8% | lr=5.0e-02
| Epoch  67, time=  2.8s | Train: skip eval | Valid: time=  0.6s loss=3.970, TAw acc= 63.6% |
| Epoch  68, time=  3.5s | Train: skip eval | Valid: time=  0.6s loss=3.974, TAw acc= 63.8% |
| Epoch  69, time=  2.8s | Train: skip eval | Valid: time=  0.6s loss=3.973, TAw acc= 63.0% |
| Epoch  70, time=  2.9s | Train: skip eval | Valid: time=  0.4s loss=3.975, TAw acc= 61.2% |
| Epoch  71, time=  2.7s | Train: skip eval | Valid: time=  0.4s loss=3.975, TAw acc= 62.0% | lr=5.0e-02
| Epoch  72, time=  2.8s | Train: skip eval | Valid: time=  0.6s loss=3.977, TAw acc= 64.0% |
| Epoch  73, time=  2.8s | Train: skip eval | Valid: time=  0.6s loss=3.978, TAw acc= 61.4% |
| Epoch  74, time=  3.3s | Train: skip eval | Valid: time=  0.5s loss=3.976, TAw acc= 66.4% |
| Epoch  75, time=  2.8s | Train: skip eval | Valid: time=  0.5s loss=3.988, TAw acc= 63.2% |
| Epoch  76, time=  2.9s | Train: skip eval | Valid: time=  0.5s loss=3.990, TAw acc= 62.0% | lr=5.0e-02
| Epoch  77, time=  3.0s | Train: skip eval | Valid: time=  1.3s loss=3.978, TAw acc= 62.6% |
| Epoch  78, time=  2.8s | Train: skip eval | Valid: time=  0.6s loss=3.978, TAw acc= 65.2% |
| Epoch  79, time=  2.6s | Train: skip eval | Valid: time=  0.5s loss=3.972, TAw acc= 63.8% |
| Epoch  80, time=  2.7s | Train: skip eval | Valid: time=  0.5s loss=3.971, TAw acc= 64.0% |
| Epoch  81, time=  3.6s | Train: skip eval | Valid: time=  0.6s loss=3.978, TAw acc= 62.8% | lr=5.0e-02
| Epoch  82, time=  2.8s | Train: skip eval | Valid: time=  0.8s loss=3.973, TAw acc= 63.8% |
| Epoch  83, time=  2.9s | Train: skip eval | Valid: time=  0.7s loss=3.973, TAw acc= 61.8% |
| Epoch  84, time=  3.5s | Train: skip eval | Valid: time=  0.5s loss=3.980, TAw acc= 63.6% |
| Epoch  85, time=  2.8s | Train: skip eval | Valid: time=  0.4s loss=3.992, TAw acc= 61.0% |
| Epoch  86, time=  2.9s | Train: skip eval | Valid: time=  0.4s loss=3.979, TAw acc= 63.2% | lr=5.0e-02
| Epoch  87, time=  2.9s | Train: skip eval | Valid: time=  0.8s loss=3.972, TAw acc= 66.2% |
| Epoch  88, time=  2.7s | Train: skip eval | Valid: time=  0.6s loss=3.975, TAw acc= 64.2% |
| Epoch  89, time=  2.7s | Train: skip eval | Valid: time=  0.6s loss=3.987, TAw acc= 62.2% |
| Epoch  90, time=  3.0s | Train: skip eval | Valid: time=  0.7s loss=3.991, TAw acc= 58.2% |
| Epoch  91, time=  2.8s | Train: skip eval | Valid: time=  0.5s loss=3.971, TAw acc= 65.6% | lr=5.0e-02
| Epoch  92, time=  2.5s | Train: skip eval | Valid: time=  0.7s loss=3.975, TAw acc= 64.4% |
| Epoch  93, time=  2.6s | Train: skip eval | Valid: time=  0.5s loss=3.974, TAw acc= 64.0% |
| Epoch  94, time=  3.8s | Train: skip eval | Valid: time=  0.5s loss=3.980, TAw acc= 62.4% |
| Epoch  95, time=  3.0s | Train: skip eval | Valid: time=  0.4s loss=3.975, TAw acc= 64.8% |
| Epoch  96, time=  2.6s | Train: skip eval | Valid: time=  0.4s loss=3.974, TAw acc= 65.4% | lr=5.0e-02
| Epoch  97, time=  2.8s | Train: skip eval | Valid: time=  0.5s loss=3.975, TAw acc= 62.0% |
| Epoch  98, time=  2.7s | Train: skip eval | Valid: time=  0.8s loss=3.981, TAw acc= 62.4% |
| Epoch  99, time=  2.7s | Train: skip eval | Valid: time=  0.6s loss=3.973, TAw acc= 65.8% |
| Epoch 100, time=  2.7s | Train: skip eval | Valid: time=  0.7s loss=3.982, TAw acc= 63.4% |
Stage 2: Training bias correction layers
| Epoch  50, time=  0.8s | Train: loss=3.491, TAg acc= 22.0% |
| Epoch 100, time=  0.6s | Train: loss=3.542, TAg acc= 20.2% |
| Epoch 150, time=  0.4s | Train: loss=3.532, TAg acc= 19.8% |
| Epoch 200, time=  0.6s | Train: loss=3.432, TAg acc= 21.6% |
Stage 2: BiC training for Task 0: alpha=1.00000, beta=0.00000
Stage 2: BiC training for Task 1: alpha=0.71168, beta=-0.79590
Stage 2: BiC training for Task 2: alpha=0.53594, beta=-0.67303
Stage 2: BiC training for Task 3: alpha=0.47521, beta=-0.56372
Stage 2: BiC training for Task 4: alpha=0.59652, beta=-0.69435
Stage 2: BiC training for Task 5: alpha=0.55322, beta=-0.57669
Stage 2: BiC training for Task 6: alpha=0.55430, beta=-0.33855
Stage 2: BiC training for Task 7: alpha=0.55138, beta=-0.45528
Stage 2: BiC training for Task 8: alpha=0.61315, beta=-0.50480
Stage 2: BiC training for Task 9: alpha=0.58156, beta=-0.42424
| Selected 4500 train exemplars, time=  0.1s
------------------------------------------------------------------------------------------------------------
>>> Test on task  0 : loss=3.838 | TAw acc= 53.3%, forg=  5.1%| TAg acc= 27.1%, forg= 29.9% <<<
>>> Test on task  1 : loss=3.548 | TAw acc= 50.6%, forg=  9.1%| TAg acc= 20.3%, forg= 28.6% <<<
>>> Test on task  2 : loss=3.462 | TAw acc= 49.3%, forg=  4.3%| TAg acc= 21.7%, forg=  7.6% <<<
>>> Test on task  3 : loss=3.528 | TAw acc= 51.1%, forg=  5.4%| TAg acc= 15.8%, forg=  9.7% <<<
>>> Test on task  4 : loss=3.319 | TAw acc= 54.9%, forg=  4.5%| TAg acc= 22.5%, forg= 11.7% <<<
>>> Test on task  5 : loss=3.391 | TAw acc= 55.3%, forg=  2.6%| TAg acc= 24.8%, forg=  6.3% <<<
>>> Test on task  6 : loss=3.503 | TAw acc= 59.9%, forg=  2.7%| TAg acc= 22.2%, forg=  8.8% <<<
>>> Test on task  7 : loss=3.695 | TAw acc= 61.9%, forg=  1.4%| TAg acc= 23.7%, forg=  3.5% <<<
>>> Test on task  8 : loss=3.780 | TAw acc= 66.3%, forg= -0.5%| TAg acc= 36.3%, forg=  0.0% <<<
>>> Test on task  9 : loss=4.072 | TAw acc= 63.7%, forg=  0.0%| TAg acc= 30.9%, forg=  0.0% <<<
Save at ../miniimagenet_bic_result10t/miniimagenet_bic
************************************************************************************************************
TAw Acc
	 57.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 	Avg.: 57.0% 
	 57.6%  59.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 	Avg.: 58.7% 
	 58.4%  58.1%  52.9%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 	Avg.: 56.5% 
	 56.9%  55.8%  50.5%  56.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 	Avg.: 54.9% 
	 56.9%  54.5%  53.6%  55.2%  59.3%   0.0%   0.0%   0.0%   0.0%   0.0% 	Avg.: 55.9% 
	 55.2%  54.7%  53.1%  55.5%  59.4%  57.9%   0.0%   0.0%   0.0%   0.0% 	Avg.: 56.0% 
	 53.6%  54.2%  49.7%  52.0%  58.5%  57.3%  62.6%   0.0%   0.0%   0.0% 	Avg.: 55.4% 
	 54.1%  53.8%  50.1%  52.0%  56.4%  55.1%  60.0%  63.3%   0.0%   0.0% 	Avg.: 55.6% 
	 54.8%  51.8%  50.1%  50.7%  54.3%  54.8%  59.1%  61.6%  65.8%   0.0% 	Avg.: 55.9% 
	 53.3%  50.6%  49.3%  51.1%  54.9%  55.3%  59.9%  61.9%  66.3%  63.7% 	Avg.: 56.6% 
************************************************************************************************************
TAg Acc
	 57.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 	Avg.: 57.0% 
	 41.5%  48.9%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 	Avg.: 45.2% 
	 42.0%  42.2%  29.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 	Avg.: 37.8% 
	 36.2%  38.2%  28.0%  25.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 	Avg.: 32.0% 
	 30.8%  31.8%  26.8%  21.1%  34.2%   0.0%   0.0%   0.0%   0.0%   0.0% 	Avg.: 28.9% 
	 32.6%  31.7%  25.8%  21.6%  28.8%  31.1%   0.0%   0.0%   0.0%   0.0% 	Avg.: 28.6% 
	 26.4%  26.7%  21.8%  18.3%  27.6%  28.9%  31.0%   0.0%   0.0%   0.0% 	Avg.: 25.8% 
	 26.5%  25.4%  21.7%  19.9%  24.0%  27.2%  27.3%  27.2%   0.0%   0.0% 	Avg.: 24.9% 
	 26.1%  21.4%  21.4%  16.5%  26.1%  25.2%  24.3%  22.0%  36.3%   0.0% 	Avg.: 24.4% 
	 27.1%  20.3%  21.7%  15.8%  22.5%  24.8%  22.2%  23.7%  36.3%  30.9% 	Avg.: 24.5% 
************************************************************************************************************
TAw Forg
	  0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
	 -0.6%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 	Avg.: -0.6% 
	 -0.8%   1.6%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 	Avg.:  0.4% 
	  1.5%   3.9%   2.4%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 	Avg.:  2.6% 
	  1.5%   5.2%  -0.7%   1.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 	Avg.:  1.8% 
	  3.2%   5.0%   0.5%   1.0%  -0.1%   0.0%   0.0%   0.0%   0.0%   0.0% 	Avg.:  1.9% 
	  4.8%   5.5%   3.9%   4.5%   0.9%   0.6%   0.0%   0.0%   0.0%   0.0% 	Avg.:  3.4% 
	  4.3%   5.9%   3.5%   4.5%   3.0%   2.8%   2.6%   0.0%   0.0%   0.0% 	Avg.:  3.8% 
	  3.6%   7.9%   3.5%   5.8%   5.1%   3.1%   3.5%   1.7%   0.0%   0.0% 	Avg.:  4.3% 
	  5.1%   9.1%   4.3%   5.4%   4.5%   2.6%   2.7%   1.4%  -0.5%   0.0% 	Avg.:  3.8% 
************************************************************************************************************
TAg Forg
	  0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 
	 15.5%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 	Avg.: 15.5% 
	 15.0%   6.7%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 	Avg.: 10.8% 
	 20.8%  10.7%   1.3%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 	Avg.: 10.9% 
	 26.2%  17.1%   2.5%   4.4%   0.0%   0.0%   0.0%   0.0%   0.0%   0.0% 	Avg.: 12.5% 
	 24.4%  17.2%   3.5%   3.9%   5.4%   0.0%   0.0%   0.0%   0.0%   0.0% 	Avg.: 10.9% 
	 30.6%  22.2%   7.5%   7.2%   6.6%   2.2%   0.0%   0.0%   0.0%   0.0% 	Avg.: 12.7% 
	 30.5%  23.5%   7.6%   5.6%  10.2%   3.9%   3.7%   0.0%   0.0%   0.0% 	Avg.: 12.1% 
	 30.9%  27.5%   7.9%   9.0%   8.1%   5.9%   6.7%   5.2%   0.0%   0.0% 	Avg.: 12.7% 
	 29.9%  28.6%   7.6%   9.7%  11.7%   6.3%   8.8%   3.5%   0.0%   0.0% 	Avg.: 11.8% 
************************************************************************************************************
[Elapsed time = 1.0 h]
Done!
